Namespace(dataset='double_colored_MNIST_counterfactual', batch_size=64, epochs=10, lr=1.0, gamma=0.7, log_interval=100, model='SES_V')

Number of trainable parameters: 619285

Train Epoch: 1 [0/100000 (0%)]	Loss: 2.667671
Train Epoch: 1 [6400/100000 (6%)]	Loss: 0.429752
Train Epoch: 1 [12800/100000 (13%)]	Loss: 0.250450
Train Epoch: 1 [19200/100000 (19%)]	Loss: 0.388917
Train Epoch: 1 [25600/100000 (26%)]	Loss: 0.394756
Train Epoch: 1 [32000/100000 (32%)]	Loss: 0.262020
Train Epoch: 1 [38400/100000 (38%)]	Loss: 0.186679
Train Epoch: 1 [44800/100000 (45%)]	Loss: 0.194020
Train Epoch: 1 [51200/100000 (51%)]	Loss: 0.020697
Train Epoch: 1 [57600/100000 (58%)]	Loss: 0.213438
Train Epoch: 1 [64000/100000 (64%)]	Loss: 0.092124
Train Epoch: 1 [70400/100000 (70%)]	Loss: 0.065154
Train Epoch: 1 [76800/100000 (77%)]	Loss: 0.050672
Train Epoch: 1 [83200/100000 (83%)]	Loss: 0.310852
Train Epoch: 1 [89600/100000 (90%)]	Loss: 0.292081
Train Epoch: 1 [96000/100000 (96%)]	Loss: 0.014026

Train set: Average loss: 0.1471, Accuracy: 91924/100000 (91.9%)


Test set test: Average loss: 0.3818, Accuracy: 9058/10000 (90.580%)

Test set test_counterfactual: Average loss: 0.3806, Accuracy: 9066/10000 (90.660%)

Test set test_counterfactual_rot: Average loss: 5.9342, Accuracy: 2043/10000 (20.430%)

Test set test_counterfactual_rot_scale: Average loss: 6.1486, Accuracy: 1851/10000 (18.510%)

Test set test_counterfactual_rot_scale_shear: Average loss: 6.2749, Accuracy: 1754/10000 (17.540%)
Train Epoch: 2 [0/100000 (0%)]	Loss: 0.161382
Train Epoch: 2 [6400/100000 (6%)]	Loss: 0.059569
Train Epoch: 2 [12800/100000 (13%)]	Loss: 0.073302
Train Epoch: 2 [19200/100000 (19%)]	Loss: 0.187417
Train Epoch: 2 [25600/100000 (26%)]	Loss: 0.060542
Train Epoch: 2 [32000/100000 (32%)]	Loss: 0.176356
Train Epoch: 2 [38400/100000 (38%)]	Loss: 0.239896
Train Epoch: 2 [44800/100000 (45%)]	Loss: 0.072555
Train Epoch: 2 [51200/100000 (51%)]	Loss: 0.054158
Train Epoch: 2 [57600/100000 (58%)]	Loss: 0.072952
Train Epoch: 2 [64000/100000 (64%)]	Loss: 0.085630
Train Epoch: 2 [70400/100000 (70%)]	Loss: 0.057588
Train Epoch: 2 [76800/100000 (77%)]	Loss: 0.160585
Train Epoch: 2 [83200/100000 (83%)]	Loss: 0.088084
Train Epoch: 2 [89600/100000 (90%)]	Loss: 0.029712
Train Epoch: 2 [96000/100000 (96%)]	Loss: 0.098199

Train set: Average loss: 0.0038, Accuracy: 96269/100000 (96.3%)


Test set test: Average loss: 0.4299, Accuracy: 9083/10000 (90.830%)

Test set test_counterfactual: Average loss: 0.4282, Accuracy: 9078/10000 (90.780%)

Test set test_counterfactual_rot: Average loss: 6.5191, Accuracy: 2058/10000 (20.580%)

Test set test_counterfactual_rot_scale: Average loss: 6.8476, Accuracy: 1910/10000 (19.100%)

Test set test_counterfactual_rot_scale_shear: Average loss: 6.9409, Accuracy: 1804/10000 (18.040%)
Train Epoch: 3 [0/100000 (0%)]	Loss: 0.058533
Train Epoch: 3 [6400/100000 (6%)]	Loss: 0.075429
Train Epoch: 3 [12800/100000 (13%)]	Loss: 0.037638
Train Epoch: 3 [19200/100000 (19%)]	Loss: 0.099491
Train Epoch: 3 [25600/100000 (26%)]	Loss: 0.127568
Train Epoch: 3 [32000/100000 (32%)]	Loss: 0.164103
Train Epoch: 3 [38400/100000 (38%)]	Loss: 0.074262
Train Epoch: 3 [44800/100000 (45%)]	Loss: 0.224195
Train Epoch: 3 [51200/100000 (51%)]	Loss: 0.076944
Train Epoch: 3 [57600/100000 (58%)]	Loss: 0.111802
Train Epoch: 3 [64000/100000 (64%)]	Loss: 0.082213
Train Epoch: 3 [70400/100000 (70%)]	Loss: 0.069283
Train Epoch: 3 [76800/100000 (77%)]	Loss: 0.193160
Train Epoch: 3 [83200/100000 (83%)]	Loss: 0.170853
Train Epoch: 3 [89600/100000 (90%)]	Loss: 0.005080
Train Epoch: 3 [96000/100000 (96%)]	Loss: 0.131350

Train set: Average loss: 0.0470, Accuracy: 97288/100000 (97.3%)


Test set test: Average loss: 0.4733, Accuracy: 9102/10000 (91.020%)

Test set test_counterfactual: Average loss: 0.4694, Accuracy: 9100/10000 (91.000%)

Test set test_counterfactual_rot: Average loss: 7.7115, Accuracy: 2026/10000 (20.260%)

Test set test_counterfactual_rot_scale: Average loss: 7.9900, Accuracy: 1868/10000 (18.680%)

Test set test_counterfactual_rot_scale_shear: Average loss: 8.1349, Accuracy: 1777/10000 (17.770%)
Train Epoch: 4 [0/100000 (0%)]	Loss: 0.193471
Train Epoch: 4 [6400/100000 (6%)]	Loss: 0.028673
Train Epoch: 4 [12800/100000 (13%)]	Loss: 0.075884
Train Epoch: 4 [19200/100000 (19%)]	Loss: 0.135482
Train Epoch: 4 [25600/100000 (26%)]	Loss: 0.009469
Train Epoch: 4 [32000/100000 (32%)]	Loss: 0.069498
Train Epoch: 4 [38400/100000 (38%)]	Loss: 0.069201
Train Epoch: 4 [44800/100000 (45%)]	Loss: 0.019092
Train Epoch: 4 [51200/100000 (51%)]	Loss: 0.010149
Train Epoch: 4 [57600/100000 (58%)]	Loss: 0.020941
Train Epoch: 4 [64000/100000 (64%)]	Loss: 0.078778
Train Epoch: 4 [70400/100000 (70%)]	Loss: 0.040434
Train Epoch: 4 [76800/100000 (77%)]	Loss: 0.071229
Train Epoch: 4 [83200/100000 (83%)]	Loss: 0.214735
Train Epoch: 4 [89600/100000 (90%)]	Loss: 0.035371
Train Epoch: 4 [96000/100000 (96%)]	Loss: 0.053993

Train set: Average loss: 0.2974, Accuracy: 97797/100000 (97.8%)


Test set test: Average loss: 0.4678, Accuracy: 9122/10000 (91.220%)

Test set test_counterfactual: Average loss: 0.4621, Accuracy: 9167/10000 (91.670%)

Test set test_counterfactual_rot: Average loss: 8.1206, Accuracy: 2024/10000 (20.240%)

Test set test_counterfactual_rot_scale: Average loss: 8.4983, Accuracy: 1893/10000 (18.930%)

Test set test_counterfactual_rot_scale_shear: Average loss: 8.6374, Accuracy: 1794/10000 (17.940%)
Train Epoch: 5 [0/100000 (0%)]	Loss: 0.080405
Train Epoch: 5 [6400/100000 (6%)]	Loss: 0.072280
Train Epoch: 5 [12800/100000 (13%)]	Loss: 0.016731
Train Epoch: 5 [19200/100000 (19%)]	Loss: 0.032684
Train Epoch: 5 [25600/100000 (26%)]	Loss: 0.067514
Train Epoch: 5 [32000/100000 (32%)]	Loss: 0.004944
Train Epoch: 5 [38400/100000 (38%)]	Loss: 0.361644
Train Epoch: 5 [44800/100000 (45%)]	Loss: 0.033156
Train Epoch: 5 [51200/100000 (51%)]	Loss: 0.068236
Train Epoch: 5 [57600/100000 (58%)]	Loss: 0.026393
Train Epoch: 5 [64000/100000 (64%)]	Loss: 0.005794
Train Epoch: 5 [70400/100000 (70%)]	Loss: 0.001149
Train Epoch: 5 [76800/100000 (77%)]	Loss: 0.060946
Train Epoch: 5 [83200/100000 (83%)]	Loss: 0.006477
Train Epoch: 5 [89600/100000 (90%)]	Loss: 0.031139
Train Epoch: 5 [96000/100000 (96%)]	Loss: 0.141045

Train set: Average loss: 0.0724, Accuracy: 98182/100000 (98.2%)


Test set test: Average loss: 0.5073, Accuracy: 9139/10000 (91.390%)

Test set test_counterfactual: Average loss: 0.5000, Accuracy: 9177/10000 (91.770%)

Test set test_counterfactual_rot: Average loss: 8.9657, Accuracy: 2039/10000 (20.390%)

Test set test_counterfactual_rot_scale: Average loss: 9.2983, Accuracy: 1906/10000 (19.060%)

Test set test_counterfactual_rot_scale_shear: Average loss: 9.4873, Accuracy: 1817/10000 (18.170%)
Train Epoch: 6 [0/100000 (0%)]	Loss: 0.031014
Train Epoch: 6 [6400/100000 (6%)]	Loss: 0.022763
Train Epoch: 6 [12800/100000 (13%)]	Loss: 0.011329
Train Epoch: 6 [19200/100000 (19%)]	Loss: 0.132102
Train Epoch: 6 [25600/100000 (26%)]	Loss: 0.046444
Train Epoch: 6 [32000/100000 (32%)]	Loss: 0.022053
Train Epoch: 6 [38400/100000 (38%)]	Loss: 0.004649
Train Epoch: 6 [44800/100000 (45%)]	Loss: 0.035501
Train Epoch: 6 [51200/100000 (51%)]	Loss: 0.008116
Train Epoch: 6 [57600/100000 (58%)]	Loss: 0.152015
Train Epoch: 6 [64000/100000 (64%)]	Loss: 0.040552
Train Epoch: 6 [70400/100000 (70%)]	Loss: 0.098584
Train Epoch: 6 [76800/100000 (77%)]	Loss: 0.037509
Train Epoch: 6 [83200/100000 (83%)]	Loss: 0.042664
Train Epoch: 6 [89600/100000 (90%)]	Loss: 0.038735
Train Epoch: 6 [96000/100000 (96%)]	Loss: 0.019445

Train set: Average loss: 0.0032, Accuracy: 98397/100000 (98.4%)


Test set test: Average loss: 0.5001, Accuracy: 9153/10000 (91.530%)

Test set test_counterfactual: Average loss: 0.5045, Accuracy: 9183/10000 (91.830%)

Test set test_counterfactual_rot: Average loss: 8.9077, Accuracy: 2043/10000 (20.430%)

Test set test_counterfactual_rot_scale: Average loss: 9.1424, Accuracy: 1934/10000 (19.340%)

Test set test_counterfactual_rot_scale_shear: Average loss: 9.3186, Accuracy: 1827/10000 (18.270%)
Train Epoch: 7 [0/100000 (0%)]	Loss: 0.069708
Train Epoch: 7 [6400/100000 (6%)]	Loss: 0.017363
Train Epoch: 7 [12800/100000 (13%)]	Loss: 0.022534
Train Epoch: 7 [19200/100000 (19%)]	Loss: 0.025316
Train Epoch: 7 [25600/100000 (26%)]	Loss: 0.077974
Train Epoch: 7 [32000/100000 (32%)]	Loss: 0.096505
Train Epoch: 7 [38400/100000 (38%)]	Loss: 0.025110
Train Epoch: 7 [44800/100000 (45%)]	Loss: 0.060506
Train Epoch: 7 [51200/100000 (51%)]	Loss: 0.010029
Train Epoch: 7 [57600/100000 (58%)]	Loss: 0.028088
Train Epoch: 7 [64000/100000 (64%)]	Loss: 0.019028
Train Epoch: 7 [70400/100000 (70%)]	Loss: 0.092749
Train Epoch: 7 [76800/100000 (77%)]	Loss: 0.004304
Train Epoch: 7 [83200/100000 (83%)]	Loss: 0.102564
Train Epoch: 7 [89600/100000 (90%)]	Loss: 0.033142
Train Epoch: 7 [96000/100000 (96%)]	Loss: 0.032771

Train set: Average loss: 0.0731, Accuracy: 98570/100000 (98.6%)


Test set test: Average loss: 0.5314, Accuracy: 9123/10000 (91.230%)

Test set test_counterfactual: Average loss: 0.5391, Accuracy: 9136/10000 (91.360%)

Test set test_counterfactual_rot: Average loss: 9.2109, Accuracy: 2000/10000 (20.000%)

Test set test_counterfactual_rot_scale: Average loss: 9.4298, Accuracy: 1921/10000 (19.210%)

Test set test_counterfactual_rot_scale_shear: Average loss: 9.6668, Accuracy: 1802/10000 (18.020%)
Train Epoch: 8 [0/100000 (0%)]	Loss: 0.005004
Train Epoch: 8 [6400/100000 (6%)]	Loss: 0.027857
Train Epoch: 8 [12800/100000 (13%)]	Loss: 0.027580
Train Epoch: 8 [19200/100000 (19%)]	Loss: 0.062771
Train Epoch: 8 [25600/100000 (26%)]	Loss: 0.014940
Train Epoch: 8 [32000/100000 (32%)]	Loss: 0.034215
Train Epoch: 8 [38400/100000 (38%)]	Loss: 0.000484
Train Epoch: 8 [44800/100000 (45%)]	Loss: 0.007938
Train Epoch: 8 [51200/100000 (51%)]	Loss: 0.015663
Train Epoch: 8 [57600/100000 (58%)]	Loss: 0.090306
Train Epoch: 8 [64000/100000 (64%)]	Loss: 0.002456
Train Epoch: 8 [70400/100000 (70%)]	Loss: 0.007420
Train Epoch: 8 [76800/100000 (77%)]	Loss: 0.060671
Train Epoch: 8 [83200/100000 (83%)]	Loss: 0.037253
Train Epoch: 8 [89600/100000 (90%)]	Loss: 0.012476
Train Epoch: 8 [96000/100000 (96%)]	Loss: 0.041953

Train set: Average loss: 0.0234, Accuracy: 98687/100000 (98.7%)


Test set test: Average loss: 0.5187, Accuracy: 9129/10000 (91.290%)

Test set test_counterfactual: Average loss: 0.5234, Accuracy: 9175/10000 (91.750%)

Test set test_counterfactual_rot: Average loss: 9.2251, Accuracy: 2021/10000 (20.210%)

Test set test_counterfactual_rot_scale: Average loss: 9.5562, Accuracy: 1917/10000 (19.170%)

Test set test_counterfactual_rot_scale_shear: Average loss: 9.7813, Accuracy: 1818/10000 (18.180%)
Train Epoch: 9 [0/100000 (0%)]	Loss: 0.015491
Train Epoch: 9 [6400/100000 (6%)]	Loss: 0.000463
Train Epoch: 9 [12800/100000 (13%)]	Loss: 0.005642
Train Epoch: 9 [19200/100000 (19%)]	Loss: 0.029992
Train Epoch: 9 [25600/100000 (26%)]	Loss: 0.388199
Train Epoch: 9 [32000/100000 (32%)]	Loss: 0.014690
Train Epoch: 9 [38400/100000 (38%)]	Loss: 0.123426
Train Epoch: 9 [44800/100000 (45%)]	Loss: 0.000123
Train Epoch: 9 [51200/100000 (51%)]	Loss: 0.007612
Train Epoch: 9 [57600/100000 (58%)]	Loss: 0.001835
Train Epoch: 9 [64000/100000 (64%)]	Loss: 0.044117
Train Epoch: 9 [70400/100000 (70%)]	Loss: 0.007980
Train Epoch: 9 [76800/100000 (77%)]	Loss: 0.053864
Train Epoch: 9 [83200/100000 (83%)]	Loss: 0.040247
Train Epoch: 9 [89600/100000 (90%)]	Loss: 0.000111
Train Epoch: 9 [96000/100000 (96%)]	Loss: 0.005433

Train set: Average loss: 0.0516, Accuracy: 98784/100000 (98.8%)


Test set test: Average loss: 0.5142, Accuracy: 9140/10000 (91.400%)

Test set test_counterfactual: Average loss: 0.5240, Accuracy: 9181/10000 (91.810%)

Test set test_counterfactual_rot: Average loss: 9.4423, Accuracy: 1995/10000 (19.950%)

Test set test_counterfactual_rot_scale: Average loss: 9.5767, Accuracy: 1905/10000 (19.050%)

Test set test_counterfactual_rot_scale_shear: Average loss: 9.8183, Accuracy: 1792/10000 (17.920%)
Train Epoch: 10 [0/100000 (0%)]	Loss: 0.012460
Train Epoch: 10 [6400/100000 (6%)]	Loss: 0.069016
Train Epoch: 10 [12800/100000 (13%)]	Loss: 0.012639
Train Epoch: 10 [19200/100000 (19%)]	Loss: 0.009402
Train Epoch: 10 [25600/100000 (26%)]	Loss: 0.000078
Train Epoch: 10 [32000/100000 (32%)]	Loss: 0.043813
Train Epoch: 10 [38400/100000 (38%)]	Loss: 0.168431
Train Epoch: 10 [44800/100000 (45%)]	Loss: 0.005707
Train Epoch: 10 [51200/100000 (51%)]	Loss: 0.087550
Train Epoch: 10 [57600/100000 (58%)]	Loss: 0.102952
Train Epoch: 10 [64000/100000 (64%)]	Loss: 0.031563
Train Epoch: 10 [70400/100000 (70%)]	Loss: 0.018299
Train Epoch: 10 [76800/100000 (77%)]	Loss: 0.009449
Train Epoch: 10 [83200/100000 (83%)]	Loss: 0.037261
Train Epoch: 10 [89600/100000 (90%)]	Loss: 0.013275
Train Epoch: 10 [96000/100000 (96%)]	Loss: 0.053146

Train set: Average loss: 0.0045, Accuracy: 98846/100000 (98.8%)


Test set test: Average loss: 0.5133, Accuracy: 9157/10000 (91.570%)

Test set test_counterfactual: Average loss: 0.5297, Accuracy: 9168/10000 (91.680%)

Test set test_counterfactual_rot: Average loss: 9.5730, Accuracy: 2023/10000 (20.230%)

Test set test_counterfactual_rot_scale: Average loss: 9.8696, Accuracy: 1913/10000 (19.130%)

Test set test_counterfactual_rot_scale_shear: Average loss: 10.1190, Accuracy: 1824/10000 (18.240%)
