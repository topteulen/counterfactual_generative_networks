Namespace(dataset='wildlife_MNIST_counterfactual', batch_size=64, epochs=10, lr=1.0, gamma=0.7, log_interval=100, model='SES')

Number of trainable parameters: 619285

Train Epoch: 1 [0/100000 (0%)]	Loss: 2.778629
Train Epoch: 1 [6400/100000 (6%)]	Loss: 0.836488
Train Epoch: 1 [12800/100000 (13%)]	Loss: 0.544803
Train Epoch: 1 [19200/100000 (19%)]	Loss: 0.349073
Train Epoch: 1 [25600/100000 (26%)]	Loss: 0.392681
Train Epoch: 1 [32000/100000 (32%)]	Loss: 0.441790
Train Epoch: 1 [38400/100000 (38%)]	Loss: 0.289105
Train Epoch: 1 [44800/100000 (45%)]	Loss: 0.158579
Train Epoch: 1 [51200/100000 (51%)]	Loss: 0.310325
Train Epoch: 1 [57600/100000 (58%)]	Loss: 0.242630
Train Epoch: 1 [64000/100000 (64%)]	Loss: 0.157029
Train Epoch: 1 [70400/100000 (70%)]	Loss: 0.274834
Train Epoch: 1 [76800/100000 (77%)]	Loss: 0.301787
Train Epoch: 1 [83200/100000 (83%)]	Loss: 0.196906
Train Epoch: 1 [89600/100000 (90%)]	Loss: 0.176611
Train Epoch: 1 [96000/100000 (96%)]	Loss: 0.287291

Train set: Average loss: 0.0492, Accuracy: 87630/100000 (87.6%)


Test set test: Average loss: 74.2651, Accuracy: 7146/10000 (71.460%)

Test set test_counterfactual: Average loss: 72.2799, Accuracy: 6877/10000 (68.770%)

Test set test_counterfactual_rot: Average loss: 693.1103, Accuracy: 1600/10000 (16.000%)

Test set test_counterfactual_rot_scale: Average loss: 625.2617, Accuracy: 1574/10000 (15.740%)

Test set test_counterfactual_rot_scale_shear: Average loss: 632.9185, Accuracy: 1344/10000 (13.440%)
Train Epoch: 2 [0/100000 (0%)]	Loss: 0.081731
Train Epoch: 2 [6400/100000 (6%)]	Loss: 0.092596
Train Epoch: 2 [12800/100000 (13%)]	Loss: 0.224266
Train Epoch: 2 [19200/100000 (19%)]	Loss: 0.145125
Train Epoch: 2 [25600/100000 (26%)]	Loss: 0.061634
Train Epoch: 2 [32000/100000 (32%)]	Loss: 0.220388
Train Epoch: 2 [38400/100000 (38%)]	Loss: 0.061258
Train Epoch: 2 [44800/100000 (45%)]	Loss: 0.090180
Train Epoch: 2 [51200/100000 (51%)]	Loss: 0.103126
Train Epoch: 2 [57600/100000 (58%)]	Loss: 0.067857
Train Epoch: 2 [64000/100000 (64%)]	Loss: 0.114050
Train Epoch: 2 [70400/100000 (70%)]	Loss: 0.188457
Train Epoch: 2 [76800/100000 (77%)]	Loss: 0.122437
Train Epoch: 2 [83200/100000 (83%)]	Loss: 0.066167
Train Epoch: 2 [89600/100000 (90%)]	Loss: 0.219502
Train Epoch: 2 [96000/100000 (96%)]	Loss: 0.169937

Train set: Average loss: 0.1237, Accuracy: 96390/100000 (96.4%)


Test set test: Average loss: 72.7486, Accuracy: 7269/10000 (72.690%)

Test set test_counterfactual: Average loss: 72.7117, Accuracy: 6859/10000 (68.590%)

Test set test_counterfactual_rot: Average loss: 569.1354, Accuracy: 1773/10000 (17.730%)

Test set test_counterfactual_rot_scale: Average loss: 548.9165, Accuracy: 1585/10000 (15.850%)

Test set test_counterfactual_rot_scale_shear: Average loss: 564.4380, Accuracy: 1452/10000 (14.520%)
Train Epoch: 3 [0/100000 (0%)]	Loss: 0.032675
Train Epoch: 3 [6400/100000 (6%)]	Loss: 0.161529
Train Epoch: 3 [12800/100000 (13%)]	Loss: 0.103013
Train Epoch: 3 [19200/100000 (19%)]	Loss: 0.015089
Train Epoch: 3 [25600/100000 (26%)]	Loss: 0.203638
Train Epoch: 3 [32000/100000 (32%)]	Loss: 0.046277
Train Epoch: 3 [38400/100000 (38%)]	Loss: 0.039896
Train Epoch: 3 [44800/100000 (45%)]	Loss: 0.105478
Train Epoch: 3 [51200/100000 (51%)]	Loss: 0.079000
Train Epoch: 3 [57600/100000 (58%)]	Loss: 0.023352
Train Epoch: 3 [64000/100000 (64%)]	Loss: 0.025339
Train Epoch: 3 [70400/100000 (70%)]	Loss: 0.162308
Train Epoch: 3 [76800/100000 (77%)]	Loss: 0.036545
Train Epoch: 3 [83200/100000 (83%)]	Loss: 0.091679
Train Epoch: 3 [89600/100000 (90%)]	Loss: 0.151958
Train Epoch: 3 [96000/100000 (96%)]	Loss: 0.011459

Train set: Average loss: 0.1432, Accuracy: 98010/100000 (98.0%)


Test set test: Average loss: 84.3935, Accuracy: 7232/10000 (72.320%)

Test set test_counterfactual: Average loss: 78.9524, Accuracy: 7024/10000 (70.240%)

Test set test_counterfactual_rot: Average loss: 644.0164, Accuracy: 1779/10000 (17.790%)

Test set test_counterfactual_rot_scale: Average loss: 604.5599, Accuracy: 1587/10000 (15.870%)

Test set test_counterfactual_rot_scale_shear: Average loss: 620.3341, Accuracy: 1438/10000 (14.380%)
Train Epoch: 4 [0/100000 (0%)]	Loss: 0.066304
Train Epoch: 4 [6400/100000 (6%)]	Loss: 0.010926
Train Epoch: 4 [12800/100000 (13%)]	Loss: 0.004534
Train Epoch: 4 [19200/100000 (19%)]	Loss: 0.101734
Train Epoch: 4 [25600/100000 (26%)]	Loss: 0.015245
Train Epoch: 4 [32000/100000 (32%)]	Loss: 0.037796
Train Epoch: 4 [38400/100000 (38%)]	Loss: 0.001007
Train Epoch: 4 [44800/100000 (45%)]	Loss: 0.061623
Train Epoch: 4 [51200/100000 (51%)]	Loss: 0.017108
Train Epoch: 4 [57600/100000 (58%)]	Loss: 0.029925
Train Epoch: 4 [64000/100000 (64%)]	Loss: 0.003567
Train Epoch: 4 [70400/100000 (70%)]	Loss: 0.000595
Train Epoch: 4 [76800/100000 (77%)]	Loss: 0.093949
Train Epoch: 4 [83200/100000 (83%)]	Loss: 0.012246
Train Epoch: 4 [89600/100000 (90%)]	Loss: 0.050782
Train Epoch: 4 [96000/100000 (96%)]	Loss: 0.006605

Train set: Average loss: 0.0562, Accuracy: 98797/100000 (98.8%)


Test set test: Average loss: 97.5963, Accuracy: 6834/10000 (68.340%)

Test set test_counterfactual: Average loss: 93.0719, Accuracy: 6653/10000 (66.530%)

Test set test_counterfactual_rot: Average loss: 693.0829, Accuracy: 1627/10000 (16.270%)

Test set test_counterfactual_rot_scale: Average loss: 648.2373, Accuracy: 1549/10000 (15.490%)

Test set test_counterfactual_rot_scale_shear: Average loss: 663.1916, Accuracy: 1388/10000 (13.880%)
Train Epoch: 5 [0/100000 (0%)]	Loss: 0.007122
Train Epoch: 5 [6400/100000 (6%)]	Loss: 0.001863
Train Epoch: 5 [12800/100000 (13%)]	Loss: 0.008614
Train Epoch: 5 [19200/100000 (19%)]	Loss: 0.019257
Train Epoch: 5 [25600/100000 (26%)]	Loss: 0.012546
Train Epoch: 5 [32000/100000 (32%)]	Loss: 0.039522
Train Epoch: 5 [38400/100000 (38%)]	Loss: 0.046460
Train Epoch: 5 [44800/100000 (45%)]	Loss: 0.008247
Train Epoch: 5 [51200/100000 (51%)]	Loss: 0.003607
Train Epoch: 5 [57600/100000 (58%)]	Loss: 0.052353
Train Epoch: 5 [64000/100000 (64%)]	Loss: 0.000311
Train Epoch: 5 [70400/100000 (70%)]	Loss: 0.001385
Train Epoch: 5 [76800/100000 (77%)]	Loss: 0.001930
Train Epoch: 5 [83200/100000 (83%)]	Loss: 0.032075
Train Epoch: 5 [89600/100000 (90%)]	Loss: 0.022302
Train Epoch: 5 [96000/100000 (96%)]	Loss: 0.032487

Train set: Average loss: 0.0074, Accuracy: 99206/100000 (99.2%)


Test set test: Average loss: 100.4695, Accuracy: 6754/10000 (67.540%)

Test set test_counterfactual: Average loss: 96.2211, Accuracy: 6559/10000 (65.590%)

Test set test_counterfactual_rot: Average loss: 597.1916, Accuracy: 1706/10000 (17.060%)

Test set test_counterfactual_rot_scale: Average loss: 583.0875, Accuracy: 1575/10000 (15.750%)

Test set test_counterfactual_rot_scale_shear: Average loss: 597.2897, Accuracy: 1414/10000 (14.140%)
Train Epoch: 6 [0/100000 (0%)]	Loss: 0.004477
Train Epoch: 6 [6400/100000 (6%)]	Loss: 0.031598
Train Epoch: 6 [12800/100000 (13%)]	Loss: 0.009692
Train Epoch: 6 [19200/100000 (19%)]	Loss: 0.007744
Train Epoch: 6 [25600/100000 (26%)]	Loss: 0.002458
Train Epoch: 6 [32000/100000 (32%)]	Loss: 0.006731
Train Epoch: 6 [38400/100000 (38%)]	Loss: 0.016561
Train Epoch: 6 [44800/100000 (45%)]	Loss: 0.000799
Train Epoch: 6 [51200/100000 (51%)]	Loss: 0.000905
Train Epoch: 6 [57600/100000 (58%)]	Loss: 0.004008
Train Epoch: 6 [64000/100000 (64%)]	Loss: 0.026790
Train Epoch: 6 [70400/100000 (70%)]	Loss: 0.004726
Train Epoch: 6 [76800/100000 (77%)]	Loss: 0.004299
Train Epoch: 6 [83200/100000 (83%)]	Loss: 0.016711
Train Epoch: 6 [89600/100000 (90%)]	Loss: 0.000587
Train Epoch: 6 [96000/100000 (96%)]	Loss: 0.004347

Train set: Average loss: 0.0038, Accuracy: 99429/100000 (99.4%)


Test set test: Average loss: 103.4789, Accuracy: 6663/10000 (66.630%)

Test set test_counterfactual: Average loss: 97.1674, Accuracy: 6483/10000 (64.830%)

Test set test_counterfactual_rot: Average loss: 608.8057, Accuracy: 1691/10000 (16.910%)

Test set test_counterfactual_rot_scale: Average loss: 585.1331, Accuracy: 1583/10000 (15.830%)

Test set test_counterfactual_rot_scale_shear: Average loss: 603.0446, Accuracy: 1415/10000 (14.150%)
Train Epoch: 7 [0/100000 (0%)]	Loss: 0.090372
Train Epoch: 7 [6400/100000 (6%)]	Loss: 0.005586
Train Epoch: 7 [12800/100000 (13%)]	Loss: 0.003607
Train Epoch: 7 [19200/100000 (19%)]	Loss: 0.016437
Train Epoch: 7 [25600/100000 (26%)]	Loss: 0.036828
Train Epoch: 7 [32000/100000 (32%)]	Loss: 0.009532
Train Epoch: 7 [38400/100000 (38%)]	Loss: 0.005052
Train Epoch: 7 [44800/100000 (45%)]	Loss: 0.002335
Train Epoch: 7 [51200/100000 (51%)]	Loss: 0.026785
Train Epoch: 7 [57600/100000 (58%)]	Loss: 0.022292
Train Epoch: 7 [64000/100000 (64%)]	Loss: 0.004228
Train Epoch: 7 [70400/100000 (70%)]	Loss: 0.002951
Train Epoch: 7 [76800/100000 (77%)]	Loss: 0.001906
Train Epoch: 7 [83200/100000 (83%)]	Loss: 0.010589
Train Epoch: 7 [89600/100000 (90%)]	Loss: 0.000943
Train Epoch: 7 [96000/100000 (96%)]	Loss: 0.002780

Train set: Average loss: 0.0071, Accuracy: 99543/100000 (99.5%)


Test set test: Average loss: 103.3916, Accuracy: 6712/10000 (67.120%)

Test set test_counterfactual: Average loss: 104.9101, Accuracy: 6432/10000 (64.320%)

Test set test_counterfactual_rot: Average loss: 668.5862, Accuracy: 1664/10000 (16.640%)

Test set test_counterfactual_rot_scale: Average loss: 625.4077, Accuracy: 1558/10000 (15.580%)

Test set test_counterfactual_rot_scale_shear: Average loss: 644.4915, Accuracy: 1404/10000 (14.040%)
Train Epoch: 8 [0/100000 (0%)]	Loss: 0.001139
Train Epoch: 8 [6400/100000 (6%)]	Loss: 0.013301
Train Epoch: 8 [12800/100000 (13%)]	Loss: 0.000356
Train Epoch: 8 [19200/100000 (19%)]	Loss: 0.007270
Train Epoch: 8 [25600/100000 (26%)]	Loss: 0.005674
Train Epoch: 8 [32000/100000 (32%)]	Loss: 0.060657
Train Epoch: 8 [38400/100000 (38%)]	Loss: 0.001989
Train Epoch: 8 [44800/100000 (45%)]	Loss: 0.032510
Train Epoch: 8 [51200/100000 (51%)]	Loss: 0.002972
Train Epoch: 8 [57600/100000 (58%)]	Loss: 0.014863
Train Epoch: 8 [64000/100000 (64%)]	Loss: 0.010645
Train Epoch: 8 [70400/100000 (70%)]	Loss: 0.014281
Train Epoch: 8 [76800/100000 (77%)]	Loss: 0.026884
Train Epoch: 8 [83200/100000 (83%)]	Loss: 0.003268
Train Epoch: 8 [89600/100000 (90%)]	Loss: 0.013790
Train Epoch: 8 [96000/100000 (96%)]	Loss: 0.019922

Train set: Average loss: 0.0052, Accuracy: 99596/100000 (99.6%)


Test set test: Average loss: 100.6319, Accuracy: 6777/10000 (67.770%)

Test set test_counterfactual: Average loss: 102.1823, Accuracy: 6422/10000 (64.220%)

Test set test_counterfactual_rot: Average loss: 641.2305, Accuracy: 1709/10000 (17.090%)

Test set test_counterfactual_rot_scale: Average loss: 609.5301, Accuracy: 1578/10000 (15.780%)

Test set test_counterfactual_rot_scale_shear: Average loss: 631.2193, Accuracy: 1419/10000 (14.190%)
Train Epoch: 9 [0/100000 (0%)]	Loss: 0.068831
Train Epoch: 9 [6400/100000 (6%)]	Loss: 0.003072
Train Epoch: 9 [12800/100000 (13%)]	Loss: 0.010576
Train Epoch: 9 [19200/100000 (19%)]	Loss: 0.000774
Train Epoch: 9 [25600/100000 (26%)]	Loss: 0.024989
Train Epoch: 9 [32000/100000 (32%)]	Loss: 0.001336
Train Epoch: 9 [38400/100000 (38%)]	Loss: 0.074657
Train Epoch: 9 [44800/100000 (45%)]	Loss: 0.000580
Train Epoch: 9 [51200/100000 (51%)]	Loss: 0.002626
Train Epoch: 9 [57600/100000 (58%)]	Loss: 0.001670
Train Epoch: 9 [64000/100000 (64%)]	Loss: 0.122780
Train Epoch: 9 [70400/100000 (70%)]	Loss: 0.001097
Train Epoch: 9 [76800/100000 (77%)]	Loss: 0.012631
Train Epoch: 9 [83200/100000 (83%)]	Loss: 0.005012
Train Epoch: 9 [89600/100000 (90%)]	Loss: 0.012266
Train Epoch: 9 [96000/100000 (96%)]	Loss: 0.004634

Train set: Average loss: 0.0007, Accuracy: 99664/100000 (99.7%)


Test set test: Average loss: 96.7136, Accuracy: 6818/10000 (68.180%)

Test set test_counterfactual: Average loss: 98.0006, Accuracy: 6466/10000 (64.660%)

Test set test_counterfactual_rot: Average loss: 627.1646, Accuracy: 1700/10000 (17.000%)

Test set test_counterfactual_rot_scale: Average loss: 592.5963, Accuracy: 1569/10000 (15.690%)

Test set test_counterfactual_rot_scale_shear: Average loss: 612.6576, Accuracy: 1401/10000 (14.010%)
Train Epoch: 10 [0/100000 (0%)]	Loss: 0.001475
Train Epoch: 10 [6400/100000 (6%)]	Loss: 0.000631
Train Epoch: 10 [12800/100000 (13%)]	Loss: 0.007658
Train Epoch: 10 [19200/100000 (19%)]	Loss: 0.029360
Train Epoch: 10 [25600/100000 (26%)]	Loss: 0.000796
Train Epoch: 10 [32000/100000 (32%)]	Loss: 0.006954
Train Epoch: 10 [38400/100000 (38%)]	Loss: 0.119779
Train Epoch: 10 [44800/100000 (45%)]	Loss: 0.002404
Train Epoch: 10 [51200/100000 (51%)]	Loss: 0.000871
Train Epoch: 10 [57600/100000 (58%)]	Loss: 0.002763
Train Epoch: 10 [64000/100000 (64%)]	Loss: 0.008638
Train Epoch: 10 [70400/100000 (70%)]	Loss: 0.001513
Train Epoch: 10 [76800/100000 (77%)]	Loss: 0.002790
Train Epoch: 10 [83200/100000 (83%)]	Loss: 0.001584
Train Epoch: 10 [89600/100000 (90%)]	Loss: 0.000998
Train Epoch: 10 [96000/100000 (96%)]	Loss: 0.007556

Train set: Average loss: 0.0038, Accuracy: 99684/100000 (99.7%)


Test set test: Average loss: 100.7364, Accuracy: 6708/10000 (67.080%)

Test set test_counterfactual: Average loss: 100.7596, Accuracy: 6397/10000 (63.970%)

Test set test_counterfactual_rot: Average loss: 634.7035, Accuracy: 1689/10000 (16.890%)

Test set test_counterfactual_rot_scale: Average loss: 600.8249, Accuracy: 1575/10000 (15.750%)

Test set test_counterfactual_rot_scale_shear: Average loss: 619.2542, Accuracy: 1390/10000 (13.900%)
