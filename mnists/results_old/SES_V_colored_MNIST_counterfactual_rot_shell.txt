Namespace(dataset='colored_MNIST_counterfactual_rot', batch_size=64, epochs=10, lr=1.0, gamma=0.7, log_interval=100, model='SES_V')

Number of trainable parameters: 619285

Train Epoch: 1 [0/100000 (0%)]	Loss: 2.403618
Train Epoch: 1 [6400/100000 (6%)]	Loss: 1.429245
Train Epoch: 1 [12800/100000 (13%)]	Loss: 1.213986
Train Epoch: 1 [19200/100000 (19%)]	Loss: 0.995569
Train Epoch: 1 [25600/100000 (26%)]	Loss: 0.838584
Train Epoch: 1 [32000/100000 (32%)]	Loss: 0.564346
Train Epoch: 1 [38400/100000 (38%)]	Loss: 0.541401
Train Epoch: 1 [44800/100000 (45%)]	Loss: 0.888236
Train Epoch: 1 [51200/100000 (51%)]	Loss: 0.432999
Train Epoch: 1 [57600/100000 (58%)]	Loss: 0.456090
Train Epoch: 1 [64000/100000 (64%)]	Loss: 0.589317
Train Epoch: 1 [70400/100000 (70%)]	Loss: 0.539719
Train Epoch: 1 [76800/100000 (77%)]	Loss: 0.369056
Train Epoch: 1 [83200/100000 (83%)]	Loss: 0.372690
Train Epoch: 1 [89600/100000 (90%)]	Loss: 0.398193
Train Epoch: 1 [96000/100000 (96%)]	Loss: 0.119754

Train set: Average loss: 0.2124, Accuracy: 75835/100000 (75.8%)


Test set test: Average loss: 0.8259, Accuracy: 7980/10000 (79.800%)

Test set test_counterfactual: Average loss: 0.8788, Accuracy: 7795/10000 (77.950%)

Test set test_counterfactual_rot: Average loss: 0.9795, Accuracy: 7554/10000 (75.540%)

Test set test_counterfactual_rot_scale: Average loss: 2.5887, Accuracy: 5334/10000 (53.340%)

Test set test_counterfactual_rot_scale_shear: Average loss: 2.7086, Accuracy: 5116/10000 (51.160%)
Train Epoch: 2 [0/100000 (0%)]	Loss: 0.124347
Train Epoch: 2 [6400/100000 (6%)]	Loss: 0.229719
Train Epoch: 2 [12800/100000 (13%)]	Loss: 0.111026
Train Epoch: 2 [19200/100000 (19%)]	Loss: 0.110344
Train Epoch: 2 [25600/100000 (26%)]	Loss: 0.060004
Train Epoch: 2 [32000/100000 (32%)]	Loss: 0.075714
Train Epoch: 2 [38400/100000 (38%)]	Loss: 0.173700
Train Epoch: 2 [44800/100000 (45%)]	Loss: 0.027153
Train Epoch: 2 [51200/100000 (51%)]	Loss: 0.133901
Train Epoch: 2 [57600/100000 (58%)]	Loss: 0.082150
Train Epoch: 2 [64000/100000 (64%)]	Loss: 0.042667
Train Epoch: 2 [70400/100000 (70%)]	Loss: 0.239344
Train Epoch: 2 [76800/100000 (77%)]	Loss: 0.117568
Train Epoch: 2 [83200/100000 (83%)]	Loss: 0.103582
Train Epoch: 2 [89600/100000 (90%)]	Loss: 0.043063
Train Epoch: 2 [96000/100000 (96%)]	Loss: 0.209444

Train set: Average loss: 0.1929, Accuracy: 94925/100000 (94.9%)


Test set test: Average loss: 0.9071, Accuracy: 8168/10000 (81.680%)

Test set test_counterfactual: Average loss: 1.0476, Accuracy: 7883/10000 (78.830%)

Test set test_counterfactual_rot: Average loss: 1.2295, Accuracy: 7582/10000 (75.820%)

Test set test_counterfactual_rot_scale: Average loss: 3.5275, Accuracy: 5402/10000 (54.020%)

Test set test_counterfactual_rot_scale_shear: Average loss: 3.7379, Accuracy: 5100/10000 (51.000%)
Train Epoch: 3 [0/100000 (0%)]	Loss: 0.134001
Train Epoch: 3 [6400/100000 (6%)]	Loss: 0.062644
Train Epoch: 3 [12800/100000 (13%)]	Loss: 0.071702
Train Epoch: 3 [19200/100000 (19%)]	Loss: 0.039180
Train Epoch: 3 [25600/100000 (26%)]	Loss: 0.068043
Train Epoch: 3 [32000/100000 (32%)]	Loss: 0.030504
Train Epoch: 3 [38400/100000 (38%)]	Loss: 0.014625
Train Epoch: 3 [44800/100000 (45%)]	Loss: 0.047357
Train Epoch: 3 [51200/100000 (51%)]	Loss: 0.081242
Train Epoch: 3 [57600/100000 (58%)]	Loss: 0.094393
Train Epoch: 3 [64000/100000 (64%)]	Loss: 0.036392
Train Epoch: 3 [70400/100000 (70%)]	Loss: 0.024525
Train Epoch: 3 [76800/100000 (77%)]	Loss: 0.048799
Train Epoch: 3 [83200/100000 (83%)]	Loss: 0.044208
Train Epoch: 3 [89600/100000 (90%)]	Loss: 0.027322
Train Epoch: 3 [96000/100000 (96%)]	Loss: 0.037543

Train set: Average loss: 0.0274, Accuracy: 98155/100000 (98.2%)


Test set test: Average loss: 1.1543, Accuracy: 8032/10000 (80.320%)

Test set test_counterfactual: Average loss: 1.3346, Accuracy: 7751/10000 (77.510%)

Test set test_counterfactual_rot: Average loss: 1.4479, Accuracy: 7660/10000 (76.600%)

Test set test_counterfactual_rot_scale: Average loss: 3.8665, Accuracy: 5583/10000 (55.830%)

Test set test_counterfactual_rot_scale_shear: Average loss: 4.1259, Accuracy: 5244/10000 (52.440%)
Train Epoch: 4 [0/100000 (0%)]	Loss: 0.072554
Train Epoch: 4 [6400/100000 (6%)]	Loss: 0.002888
Train Epoch: 4 [12800/100000 (13%)]	Loss: 0.034146
Train Epoch: 4 [19200/100000 (19%)]	Loss: 0.007756
Train Epoch: 4 [25600/100000 (26%)]	Loss: 0.019200
Train Epoch: 4 [32000/100000 (32%)]	Loss: 0.020902
Train Epoch: 4 [38400/100000 (38%)]	Loss: 0.015427
Train Epoch: 4 [44800/100000 (45%)]	Loss: 0.056128
Train Epoch: 4 [51200/100000 (51%)]	Loss: 0.014458
Train Epoch: 4 [57600/100000 (58%)]	Loss: 0.050282
Train Epoch: 4 [64000/100000 (64%)]	Loss: 0.003409
Train Epoch: 4 [70400/100000 (70%)]	Loss: 0.015066
Train Epoch: 4 [76800/100000 (77%)]	Loss: 0.009838
Train Epoch: 4 [83200/100000 (83%)]	Loss: 0.018074
Train Epoch: 4 [89600/100000 (90%)]	Loss: 0.027062
Train Epoch: 4 [96000/100000 (96%)]	Loss: 0.028893

Train set: Average loss: 0.0196, Accuracy: 99091/100000 (99.1%)


Test set test: Average loss: 1.2330, Accuracy: 8085/10000 (80.850%)

Test set test_counterfactual: Average loss: 1.4500, Accuracy: 7792/10000 (77.920%)

Test set test_counterfactual_rot: Average loss: 1.5086, Accuracy: 7730/10000 (77.300%)

Test set test_counterfactual_rot_scale: Average loss: 4.2090, Accuracy: 5562/10000 (55.620%)

Test set test_counterfactual_rot_scale_shear: Average loss: 4.5367, Accuracy: 5199/10000 (51.990%)
Train Epoch: 5 [0/100000 (0%)]	Loss: 0.046199
Train Epoch: 5 [6400/100000 (6%)]	Loss: 0.004274
Train Epoch: 5 [12800/100000 (13%)]	Loss: 0.008278
Train Epoch: 5 [19200/100000 (19%)]	Loss: 0.006694
Train Epoch: 5 [25600/100000 (26%)]	Loss: 0.012326
Train Epoch: 5 [32000/100000 (32%)]	Loss: 0.014115
Train Epoch: 5 [38400/100000 (38%)]	Loss: 0.029450
Train Epoch: 5 [44800/100000 (45%)]	Loss: 0.010740
Train Epoch: 5 [51200/100000 (51%)]	Loss: 0.001674
Train Epoch: 5 [57600/100000 (58%)]	Loss: 0.002070
Train Epoch: 5 [64000/100000 (64%)]	Loss: 0.004195
Train Epoch: 5 [70400/100000 (70%)]	Loss: 0.002882
Train Epoch: 5 [76800/100000 (77%)]	Loss: 0.022465
Train Epoch: 5 [83200/100000 (83%)]	Loss: 0.000987
Train Epoch: 5 [89600/100000 (90%)]	Loss: 0.004079
Train Epoch: 5 [96000/100000 (96%)]	Loss: 0.006459

Train set: Average loss: 0.0080, Accuracy: 99503/100000 (99.5%)


Test set test: Average loss: 1.2230, Accuracy: 8152/10000 (81.520%)

Test set test_counterfactual: Average loss: 1.4536, Accuracy: 7841/10000 (78.410%)

Test set test_counterfactual_rot: Average loss: 1.5473, Accuracy: 7744/10000 (77.440%)

Test set test_counterfactual_rot_scale: Average loss: 4.3295, Accuracy: 5563/10000 (55.630%)

Test set test_counterfactual_rot_scale_shear: Average loss: 4.6464, Accuracy: 5258/10000 (52.580%)
Train Epoch: 6 [0/100000 (0%)]	Loss: 0.004270
Train Epoch: 6 [6400/100000 (6%)]	Loss: 0.004865
Train Epoch: 6 [12800/100000 (13%)]	Loss: 0.000812
Train Epoch: 6 [19200/100000 (19%)]	Loss: 0.120927
Train Epoch: 6 [25600/100000 (26%)]	Loss: 0.001770
Train Epoch: 6 [32000/100000 (32%)]	Loss: 0.008818
Train Epoch: 6 [38400/100000 (38%)]	Loss: 0.006763
Train Epoch: 6 [44800/100000 (45%)]	Loss: 0.006583
Train Epoch: 6 [51200/100000 (51%)]	Loss: 0.006457
Train Epoch: 6 [57600/100000 (58%)]	Loss: 0.012850
Train Epoch: 6 [64000/100000 (64%)]	Loss: 0.002868
Train Epoch: 6 [70400/100000 (70%)]	Loss: 0.005824
Train Epoch: 6 [76800/100000 (77%)]	Loss: 0.009135
Train Epoch: 6 [83200/100000 (83%)]	Loss: 0.003078
Train Epoch: 6 [89600/100000 (90%)]	Loss: 0.009739
Train Epoch: 6 [96000/100000 (96%)]	Loss: 0.008855

Train set: Average loss: 0.0009, Accuracy: 99668/100000 (99.7%)


Test set test: Average loss: 1.2516, Accuracy: 8173/10000 (81.730%)

Test set test_counterfactual: Average loss: 1.4330, Accuracy: 7899/10000 (78.990%)

Test set test_counterfactual_rot: Average loss: 1.6379, Accuracy: 7748/10000 (77.480%)

Test set test_counterfactual_rot_scale: Average loss: 4.5232, Accuracy: 5561/10000 (55.610%)

Test set test_counterfactual_rot_scale_shear: Average loss: 4.8976, Accuracy: 5218/10000 (52.180%)
Train Epoch: 7 [0/100000 (0%)]	Loss: 0.046947
Train Epoch: 7 [6400/100000 (6%)]	Loss: 0.003830
Train Epoch: 7 [12800/100000 (13%)]	Loss: 0.004968
Train Epoch: 7 [19200/100000 (19%)]	Loss: 0.002649
Train Epoch: 7 [25600/100000 (26%)]	Loss: 0.002283
Train Epoch: 7 [32000/100000 (32%)]	Loss: 0.023380
Train Epoch: 7 [38400/100000 (38%)]	Loss: 0.002594
Train Epoch: 7 [44800/100000 (45%)]	Loss: 0.002679
Train Epoch: 7 [51200/100000 (51%)]	Loss: 0.001137
Train Epoch: 7 [57600/100000 (58%)]	Loss: 0.017781
Train Epoch: 7 [64000/100000 (64%)]	Loss: 0.004158
Train Epoch: 7 [70400/100000 (70%)]	Loss: 0.039873
Train Epoch: 7 [76800/100000 (77%)]	Loss: 0.003455
Train Epoch: 7 [83200/100000 (83%)]	Loss: 0.000952
Train Epoch: 7 [89600/100000 (90%)]	Loss: 0.001046
Train Epoch: 7 [96000/100000 (96%)]	Loss: 0.013418

Train set: Average loss: 0.0194, Accuracy: 99719/100000 (99.7%)


Test set test: Average loss: 1.2750, Accuracy: 8159/10000 (81.590%)

Test set test_counterfactual: Average loss: 1.5029, Accuracy: 7880/10000 (78.800%)

Test set test_counterfactual_rot: Average loss: 1.6499, Accuracy: 7777/10000 (77.770%)

Test set test_counterfactual_rot_scale: Average loss: 4.5779, Accuracy: 5622/10000 (56.220%)

Test set test_counterfactual_rot_scale_shear: Average loss: 4.9690, Accuracy: 5272/10000 (52.720%)
Train Epoch: 8 [0/100000 (0%)]	Loss: 0.003013
Train Epoch: 8 [6400/100000 (6%)]	Loss: 0.006530
Train Epoch: 8 [12800/100000 (13%)]	Loss: 0.004098
Train Epoch: 8 [19200/100000 (19%)]	Loss: 0.005341
Train Epoch: 8 [25600/100000 (26%)]	Loss: 0.002492
Train Epoch: 8 [32000/100000 (32%)]	Loss: 0.005376
Train Epoch: 8 [38400/100000 (38%)]	Loss: 0.009296
Train Epoch: 8 [44800/100000 (45%)]	Loss: 0.003880
Train Epoch: 8 [51200/100000 (51%)]	Loss: 0.000706
Train Epoch: 8 [57600/100000 (58%)]	Loss: 0.002816
Train Epoch: 8 [64000/100000 (64%)]	Loss: 0.003271
Train Epoch: 8 [70400/100000 (70%)]	Loss: 0.005635
Train Epoch: 8 [76800/100000 (77%)]	Loss: 0.000300
Train Epoch: 8 [83200/100000 (83%)]	Loss: 0.007641
Train Epoch: 8 [89600/100000 (90%)]	Loss: 0.009018
Train Epoch: 8 [96000/100000 (96%)]	Loss: 0.001886

Train set: Average loss: 0.0350, Accuracy: 99816/100000 (99.8%)


Test set test: Average loss: 1.3006, Accuracy: 8138/10000 (81.380%)

Test set test_counterfactual: Average loss: 1.4997, Accuracy: 7854/10000 (78.540%)

Test set test_counterfactual_rot: Average loss: 1.6290, Accuracy: 7783/10000 (77.830%)

Test set test_counterfactual_rot_scale: Average loss: 4.5659, Accuracy: 5589/10000 (55.890%)

Test set test_counterfactual_rot_scale_shear: Average loss: 4.9557, Accuracy: 5265/10000 (52.650%)
Train Epoch: 9 [0/100000 (0%)]	Loss: 0.000365
Train Epoch: 9 [6400/100000 (6%)]	Loss: 0.001184
Train Epoch: 9 [12800/100000 (13%)]	Loss: 0.011820
Train Epoch: 9 [19200/100000 (19%)]	Loss: 0.001283
Train Epoch: 9 [25600/100000 (26%)]	Loss: 0.000779
Train Epoch: 9 [32000/100000 (32%)]	Loss: 0.005540
Train Epoch: 9 [38400/100000 (38%)]	Loss: 0.000982
Train Epoch: 9 [44800/100000 (45%)]	Loss: 0.018339
Train Epoch: 9 [51200/100000 (51%)]	Loss: 0.003420
Train Epoch: 9 [57600/100000 (58%)]	Loss: 0.001992
Train Epoch: 9 [64000/100000 (64%)]	Loss: 0.000968
Train Epoch: 9 [70400/100000 (70%)]	Loss: 0.001096
Train Epoch: 9 [76800/100000 (77%)]	Loss: 0.003252
Train Epoch: 9 [83200/100000 (83%)]	Loss: 0.003821
Train Epoch: 9 [89600/100000 (90%)]	Loss: 0.001664
Train Epoch: 9 [96000/100000 (96%)]	Loss: 0.001679

Train set: Average loss: 0.0062, Accuracy: 99834/100000 (99.8%)


Test set test: Average loss: 1.3054, Accuracy: 8148/10000 (81.480%)

Test set test_counterfactual: Average loss: 1.5132, Accuracy: 7874/10000 (78.740%)

Test set test_counterfactual_rot: Average loss: 1.6738, Accuracy: 7754/10000 (77.540%)

Test set test_counterfactual_rot_scale: Average loss: 4.6566, Accuracy: 5611/10000 (56.110%)

Test set test_counterfactual_rot_scale_shear: Average loss: 5.0845, Accuracy: 5256/10000 (52.560%)
Train Epoch: 10 [0/100000 (0%)]	Loss: 0.000685
Train Epoch: 10 [6400/100000 (6%)]	Loss: 0.002831
Train Epoch: 10 [12800/100000 (13%)]	Loss: 0.047284
Train Epoch: 10 [19200/100000 (19%)]	Loss: 0.023340
Train Epoch: 10 [25600/100000 (26%)]	Loss: 0.002862
Train Epoch: 10 [32000/100000 (32%)]	Loss: 0.012588
Train Epoch: 10 [38400/100000 (38%)]	Loss: 0.000479
Train Epoch: 10 [44800/100000 (45%)]	Loss: 0.002138
Train Epoch: 10 [51200/100000 (51%)]	Loss: 0.080439
Train Epoch: 10 [57600/100000 (58%)]	Loss: 0.000454
Train Epoch: 10 [64000/100000 (64%)]	Loss: 0.020750
Train Epoch: 10 [70400/100000 (70%)]	Loss: 0.001166
Train Epoch: 10 [76800/100000 (77%)]	Loss: 0.000528
Train Epoch: 10 [83200/100000 (83%)]	Loss: 0.000304
Train Epoch: 10 [89600/100000 (90%)]	Loss: 0.018663
Train Epoch: 10 [96000/100000 (96%)]	Loss: 0.001018

Train set: Average loss: 0.0121, Accuracy: 99831/100000 (99.8%)


Test set test: Average loss: 1.2901, Accuracy: 8164/10000 (81.640%)

Test set test_counterfactual: Average loss: 1.5054, Accuracy: 7892/10000 (78.920%)

Test set test_counterfactual_rot: Average loss: 1.6412, Accuracy: 7788/10000 (77.880%)

Test set test_counterfactual_rot_scale: Average loss: 4.6000, Accuracy: 5631/10000 (56.310%)

Test set test_counterfactual_rot_scale_shear: Average loss: 4.9911, Accuracy: 5299/10000 (52.990%)
