Namespace(dataset='wildlife_MNIST_counterfactual_rot_scale', batch_size=64, epochs=10, lr=1.0, gamma=0.7, log_interval=100, model='SES')

Number of trainable parameters: 619285

Train Epoch: 1 [0/100000 (0%)]	Loss: 2.467155
Train Epoch: 1 [6400/100000 (6%)]	Loss: 2.468749
Train Epoch: 1 [12800/100000 (13%)]	Loss: 2.387545
Train Epoch: 1 [19200/100000 (19%)]	Loss: 2.183841
Train Epoch: 1 [25600/100000 (26%)]	Loss: 2.108342
Train Epoch: 1 [32000/100000 (32%)]	Loss: 2.141475
Train Epoch: 1 [38400/100000 (38%)]	Loss: 2.055445
Train Epoch: 1 [44800/100000 (45%)]	Loss: 2.020413
Train Epoch: 1 [51200/100000 (51%)]	Loss: 2.088466
Train Epoch: 1 [57600/100000 (58%)]	Loss: 1.701409
Train Epoch: 1 [64000/100000 (64%)]	Loss: 1.837547
Train Epoch: 1 [70400/100000 (70%)]	Loss: 1.740102
Train Epoch: 1 [76800/100000 (77%)]	Loss: 1.780164
Train Epoch: 1 [83200/100000 (83%)]	Loss: 1.662047
Train Epoch: 1 [89600/100000 (90%)]	Loss: 1.768900
Train Epoch: 1 [96000/100000 (96%)]	Loss: 1.933062

Train set: Average loss: 1.8077, Accuracy: 26894/100000 (26.9%)


Test set test: Average loss: 87.6044, Accuracy: 3942/10000 (39.420%)

Test set test_counterfactual: Average loss: 77.7602, Accuracy: 4042/10000 (40.420%)

Test set test_counterfactual_rot: Average loss: 315.0539, Accuracy: 2360/10000 (23.600%)

Test set test_counterfactual_rot_scale: Average loss: 227.4235, Accuracy: 2746/10000 (27.460%)

Test set test_counterfactual_rot_scale_shear: Average loss: 258.8029, Accuracy: 2146/10000 (21.460%)
Train Epoch: 2 [0/100000 (0%)]	Loss: 1.648013
Train Epoch: 2 [6400/100000 (6%)]	Loss: 1.718984
Train Epoch: 2 [12800/100000 (13%)]	Loss: 1.766504
Train Epoch: 2 [19200/100000 (19%)]	Loss: 1.576779
Train Epoch: 2 [25600/100000 (26%)]	Loss: 1.961548
Train Epoch: 2 [32000/100000 (32%)]	Loss: 1.424820
Train Epoch: 2 [38400/100000 (38%)]	Loss: 1.501131
Train Epoch: 2 [44800/100000 (45%)]	Loss: 1.673402
Train Epoch: 2 [51200/100000 (51%)]	Loss: 1.699068
Train Epoch: 2 [57600/100000 (58%)]	Loss: 1.667892
Train Epoch: 2 [64000/100000 (64%)]	Loss: 1.804736
Train Epoch: 2 [70400/100000 (70%)]	Loss: 1.359222
Train Epoch: 2 [76800/100000 (77%)]	Loss: 1.206640
Train Epoch: 2 [83200/100000 (83%)]	Loss: 1.280586
Train Epoch: 2 [89600/100000 (90%)]	Loss: 1.167326
Train Epoch: 2 [96000/100000 (96%)]	Loss: 1.928791

Train set: Average loss: 1.5731, Accuracy: 45870/100000 (45.9%)


Test set test: Average loss: 71.7219, Accuracy: 5276/10000 (52.760%)

Test set test_counterfactual: Average loss: 66.2095, Accuracy: 5116/10000 (51.160%)

Test set test_counterfactual_rot: Average loss: 384.8429, Accuracy: 2703/10000 (27.030%)

Test set test_counterfactual_rot_scale: Average loss: 250.2694, Accuracy: 3285/10000 (32.850%)

Test set test_counterfactual_rot_scale_shear: Average loss: 309.5113, Accuracy: 2392/10000 (23.920%)
Train Epoch: 3 [0/100000 (0%)]	Loss: 1.454272
Train Epoch: 3 [6400/100000 (6%)]	Loss: 1.383869
Train Epoch: 3 [12800/100000 (13%)]	Loss: 1.388955
Train Epoch: 3 [19200/100000 (19%)]	Loss: 1.243163
Train Epoch: 3 [25600/100000 (26%)]	Loss: 1.492820
Train Epoch: 3 [32000/100000 (32%)]	Loss: 1.193970
Train Epoch: 3 [38400/100000 (38%)]	Loss: 1.377397
Train Epoch: 3 [44800/100000 (45%)]	Loss: 1.203195
Train Epoch: 3 [51200/100000 (51%)]	Loss: 1.334944
Train Epoch: 3 [57600/100000 (58%)]	Loss: 1.194151
Train Epoch: 3 [64000/100000 (64%)]	Loss: 1.108323
Train Epoch: 3 [70400/100000 (70%)]	Loss: 1.463916
Train Epoch: 3 [76800/100000 (77%)]	Loss: 1.587591
Train Epoch: 3 [83200/100000 (83%)]	Loss: 1.189020
Train Epoch: 3 [89600/100000 (90%)]	Loss: 1.542516
Train Epoch: 3 [96000/100000 (96%)]	Loss: 1.255305

Train set: Average loss: 1.1726, Accuracy: 54126/100000 (54.1%)


Test set test: Average loss: 89.2421, Accuracy: 5812/10000 (58.120%)

Test set test_counterfactual: Average loss: 82.8971, Accuracy: 5536/10000 (55.360%)

Test set test_counterfactual_rot: Average loss: 418.9334, Accuracy: 2922/10000 (29.220%)

Test set test_counterfactual_rot_scale: Average loss: 273.6055, Accuracy: 3663/10000 (36.630%)

Test set test_counterfactual_rot_scale_shear: Average loss: 342.7666, Accuracy: 2634/10000 (26.340%)
Train Epoch: 4 [0/100000 (0%)]	Loss: 1.200837
Train Epoch: 4 [6400/100000 (6%)]	Loss: 1.011859
Train Epoch: 4 [12800/100000 (13%)]	Loss: 1.050561
Train Epoch: 4 [19200/100000 (19%)]	Loss: 0.861099
Train Epoch: 4 [25600/100000 (26%)]	Loss: 1.106863
Train Epoch: 4 [32000/100000 (32%)]	Loss: 1.227067
Train Epoch: 4 [38400/100000 (38%)]	Loss: 1.042162
Train Epoch: 4 [44800/100000 (45%)]	Loss: 1.258736
Train Epoch: 4 [51200/100000 (51%)]	Loss: 1.096019
Train Epoch: 4 [57600/100000 (58%)]	Loss: 1.009633
Train Epoch: 4 [64000/100000 (64%)]	Loss: 1.066316
Train Epoch: 4 [70400/100000 (70%)]	Loss: 1.158123
Train Epoch: 4 [76800/100000 (77%)]	Loss: 1.057983
Train Epoch: 4 [83200/100000 (83%)]	Loss: 1.003957
Train Epoch: 4 [89600/100000 (90%)]	Loss: 1.175076
Train Epoch: 4 [96000/100000 (96%)]	Loss: 1.053814

Train set: Average loss: 1.1605, Accuracy: 59725/100000 (59.7%)


Test set test: Average loss: 81.6731, Accuracy: 6106/10000 (61.060%)

Test set test_counterfactual: Average loss: 89.4732, Accuracy: 5463/10000 (54.630%)

Test set test_counterfactual_rot: Average loss: 528.0402, Accuracy: 2923/10000 (29.230%)

Test set test_counterfactual_rot_scale: Average loss: 320.4360, Accuracy: 3604/10000 (36.040%)

Test set test_counterfactual_rot_scale_shear: Average loss: 397.0591, Accuracy: 2610/10000 (26.100%)
Train Epoch: 5 [0/100000 (0%)]	Loss: 0.724083
Train Epoch: 5 [6400/100000 (6%)]	Loss: 1.193223
Train Epoch: 5 [12800/100000 (13%)]	Loss: 0.805770
Train Epoch: 5 [19200/100000 (19%)]	Loss: 0.969300
Train Epoch: 5 [25600/100000 (26%)]	Loss: 1.053120
Train Epoch: 5 [32000/100000 (32%)]	Loss: 0.992726
Train Epoch: 5 [38400/100000 (38%)]	Loss: 0.953319
Train Epoch: 5 [44800/100000 (45%)]	Loss: 0.966874
Train Epoch: 5 [51200/100000 (51%)]	Loss: 0.653954
Train Epoch: 5 [57600/100000 (58%)]	Loss: 1.422201
Train Epoch: 5 [64000/100000 (64%)]	Loss: 1.107133
Train Epoch: 5 [70400/100000 (70%)]	Loss: 0.989193
Train Epoch: 5 [76800/100000 (77%)]	Loss: 1.524453
Train Epoch: 5 [83200/100000 (83%)]	Loss: 0.947750
Train Epoch: 5 [89600/100000 (90%)]	Loss: 0.755593
Train Epoch: 5 [96000/100000 (96%)]	Loss: 1.237254

Train set: Average loss: 1.1714, Accuracy: 63584/100000 (63.6%)


Test set test: Average loss: 113.6131, Accuracy: 5769/10000 (57.690%)

Test set test_counterfactual: Average loss: 115.3055, Accuracy: 5455/10000 (54.550%)

Test set test_counterfactual_rot: Average loss: 698.0569, Accuracy: 2789/10000 (27.890%)

Test set test_counterfactual_rot_scale: Average loss: 414.0410, Accuracy: 3543/10000 (35.430%)

Test set test_counterfactual_rot_scale_shear: Average loss: 517.0522, Accuracy: 2567/10000 (25.670%)
Train Epoch: 6 [0/100000 (0%)]	Loss: 1.045380
Train Epoch: 6 [6400/100000 (6%)]	Loss: 0.796566
Train Epoch: 6 [12800/100000 (13%)]	Loss: 0.935537
Train Epoch: 6 [19200/100000 (19%)]	Loss: 0.853463
Train Epoch: 6 [25600/100000 (26%)]	Loss: 0.846231
Train Epoch: 6 [32000/100000 (32%)]	Loss: 0.840017
Train Epoch: 6 [38400/100000 (38%)]	Loss: 1.164402
Train Epoch: 6 [44800/100000 (45%)]	Loss: 0.833463
Train Epoch: 6 [51200/100000 (51%)]	Loss: 1.070384
Train Epoch: 6 [57600/100000 (58%)]	Loss: 0.988888
Train Epoch: 6 [64000/100000 (64%)]	Loss: 1.008133
Train Epoch: 6 [70400/100000 (70%)]	Loss: 0.965014
Train Epoch: 6 [76800/100000 (77%)]	Loss: 0.862930
Train Epoch: 6 [83200/100000 (83%)]	Loss: 0.907380
Train Epoch: 6 [89600/100000 (90%)]	Loss: 0.829624
Train Epoch: 6 [96000/100000 (96%)]	Loss: 0.928232

Train set: Average loss: 0.8877, Accuracy: 66633/100000 (66.6%)


Test set test: Average loss: 113.4403, Accuracy: 5970/10000 (59.700%)

Test set test_counterfactual: Average loss: 121.5159, Accuracy: 5449/10000 (54.490%)

Test set test_counterfactual_rot: Average loss: 682.7005, Accuracy: 2924/10000 (29.240%)

Test set test_counterfactual_rot_scale: Average loss: 397.2210, Accuracy: 3690/10000 (36.900%)

Test set test_counterfactual_rot_scale_shear: Average loss: 499.3810, Accuracy: 2646/10000 (26.460%)
Train Epoch: 7 [0/100000 (0%)]	Loss: 0.928446
Train Epoch: 7 [6400/100000 (6%)]	Loss: 0.715855
Train Epoch: 7 [12800/100000 (13%)]	Loss: 0.906869
Train Epoch: 7 [19200/100000 (19%)]	Loss: 0.875990
Train Epoch: 7 [25600/100000 (26%)]	Loss: 0.665616
Train Epoch: 7 [32000/100000 (32%)]	Loss: 0.996641
Train Epoch: 7 [38400/100000 (38%)]	Loss: 0.941456
Train Epoch: 7 [44800/100000 (45%)]	Loss: 0.648101
Train Epoch: 7 [51200/100000 (51%)]	Loss: 0.560385
Train Epoch: 7 [57600/100000 (58%)]	Loss: 0.823352
Train Epoch: 7 [64000/100000 (64%)]	Loss: 0.887422
Train Epoch: 7 [70400/100000 (70%)]	Loss: 0.835576
Train Epoch: 7 [76800/100000 (77%)]	Loss: 0.935749
Train Epoch: 7 [83200/100000 (83%)]	Loss: 0.884661
Train Epoch: 7 [89600/100000 (90%)]	Loss: 1.115044
Train Epoch: 7 [96000/100000 (96%)]	Loss: 0.909435

Train set: Average loss: 0.9779, Accuracy: 69043/100000 (69.0%)


Test set test: Average loss: 115.5214, Accuracy: 6022/10000 (60.220%)

Test set test_counterfactual: Average loss: 134.5077, Accuracy: 5310/10000 (53.100%)

Test set test_counterfactual_rot: Average loss: 746.9970, Accuracy: 2861/10000 (28.610%)

Test set test_counterfactual_rot_scale: Average loss: 426.0973, Accuracy: 3701/10000 (37.010%)

Test set test_counterfactual_rot_scale_shear: Average loss: 552.8232, Accuracy: 2607/10000 (26.070%)
Train Epoch: 8 [0/100000 (0%)]	Loss: 0.749311
Train Epoch: 8 [6400/100000 (6%)]	Loss: 0.916398
Train Epoch: 8 [12800/100000 (13%)]	Loss: 0.723725
Train Epoch: 8 [19200/100000 (19%)]	Loss: 0.869479
Train Epoch: 8 [25600/100000 (26%)]	Loss: 0.762569
Train Epoch: 8 [32000/100000 (32%)]	Loss: 0.798542
Train Epoch: 8 [38400/100000 (38%)]	Loss: 1.320859
Train Epoch: 8 [44800/100000 (45%)]	Loss: 0.885829
Train Epoch: 8 [51200/100000 (51%)]	Loss: 0.762992
Train Epoch: 8 [57600/100000 (58%)]	Loss: 0.904367
Train Epoch: 8 [64000/100000 (64%)]	Loss: 0.851603
Train Epoch: 8 [70400/100000 (70%)]	Loss: 0.909213
Train Epoch: 8 [76800/100000 (77%)]	Loss: 0.854806
Train Epoch: 8 [83200/100000 (83%)]	Loss: 1.028032
Train Epoch: 8 [89600/100000 (90%)]	Loss: 0.879498
Train Epoch: 8 [96000/100000 (96%)]	Loss: 0.753871

Train set: Average loss: 0.8389, Accuracy: 70806/100000 (70.8%)


Test set test: Average loss: 126.7932, Accuracy: 5953/10000 (59.530%)

Test set test_counterfactual: Average loss: 142.7179, Accuracy: 5352/10000 (53.520%)

Test set test_counterfactual_rot: Average loss: 792.8668, Accuracy: 2878/10000 (28.780%)

Test set test_counterfactual_rot_scale: Average loss: 460.5861, Accuracy: 3689/10000 (36.890%)

Test set test_counterfactual_rot_scale_shear: Average loss: 590.8366, Accuracy: 2658/10000 (26.580%)
Train Epoch: 9 [0/100000 (0%)]	Loss: 0.830124
Train Epoch: 9 [6400/100000 (6%)]	Loss: 0.506901
Train Epoch: 9 [12800/100000 (13%)]	Loss: 0.736835
Train Epoch: 9 [19200/100000 (19%)]	Loss: 0.701691
Train Epoch: 9 [25600/100000 (26%)]	Loss: 0.878428
Train Epoch: 9 [32000/100000 (32%)]	Loss: 0.969274
Train Epoch: 9 [38400/100000 (38%)]	Loss: 0.674839
Train Epoch: 9 [44800/100000 (45%)]	Loss: 0.700188
Train Epoch: 9 [51200/100000 (51%)]	Loss: 0.916395
Train Epoch: 9 [57600/100000 (58%)]	Loss: 0.981267
Train Epoch: 9 [64000/100000 (64%)]	Loss: 0.611866
Train Epoch: 9 [70400/100000 (70%)]	Loss: 0.658477
Train Epoch: 9 [76800/100000 (77%)]	Loss: 0.767031
Train Epoch: 9 [83200/100000 (83%)]	Loss: 0.846616
Train Epoch: 9 [89600/100000 (90%)]	Loss: 0.747939
Train Epoch: 9 [96000/100000 (96%)]	Loss: 0.582714

Train set: Average loss: 1.0353, Accuracy: 72471/100000 (72.5%)


Test set test: Average loss: 139.7177, Accuracy: 5767/10000 (57.670%)

Test set test_counterfactual: Average loss: 153.4088, Accuracy: 5264/10000 (52.640%)

Test set test_counterfactual_rot: Average loss: 814.7567, Accuracy: 2868/10000 (28.680%)

Test set test_counterfactual_rot_scale: Average loss: 469.5795, Accuracy: 3665/10000 (36.650%)

Test set test_counterfactual_rot_scale_shear: Average loss: 606.0356, Accuracy: 2578/10000 (25.780%)
Train Epoch: 10 [0/100000 (0%)]	Loss: 0.514361
Train Epoch: 10 [6400/100000 (6%)]	Loss: 0.679958
Train Epoch: 10 [12800/100000 (13%)]	Loss: 0.705446
Train Epoch: 10 [19200/100000 (19%)]	Loss: 0.788484
Train Epoch: 10 [25600/100000 (26%)]	Loss: 0.899619
Train Epoch: 10 [32000/100000 (32%)]	Loss: 0.663471
Train Epoch: 10 [38400/100000 (38%)]	Loss: 0.602902
Train Epoch: 10 [44800/100000 (45%)]	Loss: 0.568791
Train Epoch: 10 [51200/100000 (51%)]	Loss: 0.605568
Train Epoch: 10 [57600/100000 (58%)]	Loss: 0.815371
Train Epoch: 10 [64000/100000 (64%)]	Loss: 0.733316
Train Epoch: 10 [70400/100000 (70%)]	Loss: 0.845615
Train Epoch: 10 [76800/100000 (77%)]	Loss: 0.625549
Train Epoch: 10 [83200/100000 (83%)]	Loss: 0.729394
Train Epoch: 10 [89600/100000 (90%)]	Loss: 0.819651
Train Epoch: 10 [96000/100000 (96%)]	Loss: 0.514194

Train set: Average loss: 0.9053, Accuracy: 73521/100000 (73.5%)


Test set test: Average loss: 144.7079, Accuracy: 5782/10000 (57.820%)

Test set test_counterfactual: Average loss: 160.9918, Accuracy: 5243/10000 (52.430%)

Test set test_counterfactual_rot: Average loss: 833.7242, Accuracy: 2883/10000 (28.830%)

Test set test_counterfactual_rot_scale: Average loss: 480.6571, Accuracy: 3698/10000 (36.980%)

Test set test_counterfactual_rot_scale_shear: Average loss: 628.6424, Accuracy: 2602/10000 (26.020%)
