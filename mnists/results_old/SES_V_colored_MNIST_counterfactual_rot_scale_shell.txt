Namespace(dataset='colored_MNIST_counterfactual_rot_scale', batch_size=64, epochs=10, lr=1.0, gamma=0.7, log_interval=100, model='SES_V')

Number of trainable parameters: 619285

Train Epoch: 1 [0/100000 (0%)]	Loss: 2.550295
Train Epoch: 1 [6400/100000 (6%)]	Loss: 1.826898
Train Epoch: 1 [12800/100000 (13%)]	Loss: 1.585850
Train Epoch: 1 [19200/100000 (19%)]	Loss: 1.308165
Train Epoch: 1 [25600/100000 (26%)]	Loss: 1.143142
Train Epoch: 1 [32000/100000 (32%)]	Loss: 0.916470
Train Epoch: 1 [38400/100000 (38%)]	Loss: 0.794978
Train Epoch: 1 [44800/100000 (45%)]	Loss: 0.722332
Train Epoch: 1 [51200/100000 (51%)]	Loss: 0.661171
Train Epoch: 1 [57600/100000 (58%)]	Loss: 0.699362
Train Epoch: 1 [64000/100000 (64%)]	Loss: 0.766349
Train Epoch: 1 [70400/100000 (70%)]	Loss: 0.692669
Train Epoch: 1 [76800/100000 (77%)]	Loss: 0.591226
Train Epoch: 1 [83200/100000 (83%)]	Loss: 0.771544
Train Epoch: 1 [89600/100000 (90%)]	Loss: 0.565167
Train Epoch: 1 [96000/100000 (96%)]	Loss: 0.302438

Train set: Average loss: 0.4757, Accuracy: 67165/100000 (67.2%)


Test set test: Average loss: 0.8313, Accuracy: 7736/10000 (77.360%)

Test set test_counterfactual: Average loss: 0.8374, Accuracy: 7610/10000 (76.100%)

Test set test_counterfactual_rot: Average loss: 1.0336, Accuracy: 7178/10000 (71.780%)

Test set test_counterfactual_rot_scale: Average loss: 1.2020, Accuracy: 6798/10000 (67.980%)

Test set test_counterfactual_rot_scale_shear: Average loss: 1.5382, Accuracy: 6313/10000 (63.130%)
Train Epoch: 2 [0/100000 (0%)]	Loss: 0.429823
Train Epoch: 2 [6400/100000 (6%)]	Loss: 0.285364
Train Epoch: 2 [12800/100000 (13%)]	Loss: 0.486685
Train Epoch: 2 [19200/100000 (19%)]	Loss: 0.386451
Train Epoch: 2 [25600/100000 (26%)]	Loss: 0.275349
Train Epoch: 2 [32000/100000 (32%)]	Loss: 0.255040
Train Epoch: 2 [38400/100000 (38%)]	Loss: 0.225377
Train Epoch: 2 [44800/100000 (45%)]	Loss: 0.182491
Train Epoch: 2 [51200/100000 (51%)]	Loss: 0.116604
Train Epoch: 2 [57600/100000 (58%)]	Loss: 0.232617
Train Epoch: 2 [64000/100000 (64%)]	Loss: 0.167082
Train Epoch: 2 [70400/100000 (70%)]	Loss: 0.134250
Train Epoch: 2 [76800/100000 (77%)]	Loss: 0.138699
Train Epoch: 2 [83200/100000 (83%)]	Loss: 0.368456
Train Epoch: 2 [89600/100000 (90%)]	Loss: 0.236238
Train Epoch: 2 [96000/100000 (96%)]	Loss: 0.083762

Train set: Average loss: 0.5226, Accuracy: 90878/100000 (90.9%)


Test set test: Average loss: 1.1137, Accuracy: 7569/10000 (75.690%)

Test set test_counterfactual: Average loss: 1.0548, Accuracy: 7702/10000 (77.020%)

Test set test_counterfactual_rot: Average loss: 1.2153, Accuracy: 7373/10000 (73.730%)

Test set test_counterfactual_rot_scale: Average loss: 1.3133, Accuracy: 7120/10000 (71.200%)

Test set test_counterfactual_rot_scale_shear: Average loss: 1.7212, Accuracy: 6602/10000 (66.020%)
Train Epoch: 3 [0/100000 (0%)]	Loss: 0.270562
Train Epoch: 3 [6400/100000 (6%)]	Loss: 0.143211
Train Epoch: 3 [12800/100000 (13%)]	Loss: 0.157926
Train Epoch: 3 [19200/100000 (19%)]	Loss: 0.191311
Train Epoch: 3 [25600/100000 (26%)]	Loss: 0.127072
Train Epoch: 3 [32000/100000 (32%)]	Loss: 0.081699
Train Epoch: 3 [38400/100000 (38%)]	Loss: 0.121001
Train Epoch: 3 [44800/100000 (45%)]	Loss: 0.214602
Train Epoch: 3 [51200/100000 (51%)]	Loss: 0.244036
Train Epoch: 3 [57600/100000 (58%)]	Loss: 0.057579
Train Epoch: 3 [64000/100000 (64%)]	Loss: 0.210322
Train Epoch: 3 [70400/100000 (70%)]	Loss: 0.043144
Train Epoch: 3 [76800/100000 (77%)]	Loss: 0.060891
Train Epoch: 3 [83200/100000 (83%)]	Loss: 0.106929
Train Epoch: 3 [89600/100000 (90%)]	Loss: 0.162528
Train Epoch: 3 [96000/100000 (96%)]	Loss: 0.042615

Train set: Average loss: 0.2222, Accuracy: 96426/100000 (96.4%)


Test set test: Average loss: 1.2296, Accuracy: 7802/10000 (78.020%)

Test set test_counterfactual: Average loss: 1.2749, Accuracy: 7681/10000 (76.810%)

Test set test_counterfactual_rot: Average loss: 1.3755, Accuracy: 7493/10000 (74.930%)

Test set test_counterfactual_rot_scale: Average loss: 1.5329, Accuracy: 7153/10000 (71.530%)

Test set test_counterfactual_rot_scale_shear: Average loss: 1.9415, Accuracy: 6692/10000 (66.920%)
Train Epoch: 4 [0/100000 (0%)]	Loss: 0.102197
Train Epoch: 4 [6400/100000 (6%)]	Loss: 0.016862
Train Epoch: 4 [12800/100000 (13%)]	Loss: 0.068815
Train Epoch: 4 [19200/100000 (19%)]	Loss: 0.115088
Train Epoch: 4 [25600/100000 (26%)]	Loss: 0.018150
Train Epoch: 4 [32000/100000 (32%)]	Loss: 0.028143
Train Epoch: 4 [38400/100000 (38%)]	Loss: 0.013459
Train Epoch: 4 [44800/100000 (45%)]	Loss: 0.071727
Train Epoch: 4 [51200/100000 (51%)]	Loss: 0.032392
Train Epoch: 4 [57600/100000 (58%)]	Loss: 0.106108
Train Epoch: 4 [64000/100000 (64%)]	Loss: 0.029588
Train Epoch: 4 [70400/100000 (70%)]	Loss: 0.087459
Train Epoch: 4 [76800/100000 (77%)]	Loss: 0.082224
Train Epoch: 4 [83200/100000 (83%)]	Loss: 0.037132
Train Epoch: 4 [89600/100000 (90%)]	Loss: 0.098049
Train Epoch: 4 [96000/100000 (96%)]	Loss: 0.047815

Train set: Average loss: 0.0788, Accuracy: 98190/100000 (98.2%)


Test set test: Average loss: 1.3291, Accuracy: 7659/10000 (76.590%)

Test set test_counterfactual: Average loss: 1.4172, Accuracy: 7563/10000 (75.630%)

Test set test_counterfactual_rot: Average loss: 1.6965, Accuracy: 7221/10000 (72.210%)

Test set test_counterfactual_rot_scale: Average loss: 1.8463, Accuracy: 6898/10000 (68.980%)

Test set test_counterfactual_rot_scale_shear: Average loss: 2.3162, Accuracy: 6508/10000 (65.080%)
Train Epoch: 5 [0/100000 (0%)]	Loss: 0.038437
Train Epoch: 5 [6400/100000 (6%)]	Loss: 0.017307
Train Epoch: 5 [12800/100000 (13%)]	Loss: 0.010899
Train Epoch: 5 [19200/100000 (19%)]	Loss: 0.033043
Train Epoch: 5 [25600/100000 (26%)]	Loss: 0.026263
Train Epoch: 5 [32000/100000 (32%)]	Loss: 0.062919
Train Epoch: 5 [38400/100000 (38%)]	Loss: 0.017339
Train Epoch: 5 [44800/100000 (45%)]	Loss: 0.051867
Train Epoch: 5 [51200/100000 (51%)]	Loss: 0.010510
Train Epoch: 5 [57600/100000 (58%)]	Loss: 0.015535
Train Epoch: 5 [64000/100000 (64%)]	Loss: 0.012541
Train Epoch: 5 [70400/100000 (70%)]	Loss: 0.030090
Train Epoch: 5 [76800/100000 (77%)]	Loss: 0.008066
Train Epoch: 5 [83200/100000 (83%)]	Loss: 0.005060
Train Epoch: 5 [89600/100000 (90%)]	Loss: 0.072710
Train Epoch: 5 [96000/100000 (96%)]	Loss: 0.051584

Train set: Average loss: 0.0175, Accuracy: 98998/100000 (99.0%)


Test set test: Average loss: 1.4320, Accuracy: 7753/10000 (77.530%)

Test set test_counterfactual: Average loss: 1.5621, Accuracy: 7695/10000 (76.950%)

Test set test_counterfactual_rot: Average loss: 1.9008, Accuracy: 7226/10000 (72.260%)

Test set test_counterfactual_rot_scale: Average loss: 2.0821, Accuracy: 6984/10000 (69.840%)

Test set test_counterfactual_rot_scale_shear: Average loss: 2.6859, Accuracy: 6540/10000 (65.400%)
Train Epoch: 6 [0/100000 (0%)]	Loss: 0.033312
Train Epoch: 6 [6400/100000 (6%)]	Loss: 0.004522
Train Epoch: 6 [12800/100000 (13%)]	Loss: 0.017719
Train Epoch: 6 [19200/100000 (19%)]	Loss: 0.013799
Train Epoch: 6 [25600/100000 (26%)]	Loss: 0.002774
Train Epoch: 6 [32000/100000 (32%)]	Loss: 0.021206
Train Epoch: 6 [38400/100000 (38%)]	Loss: 0.072604
Train Epoch: 6 [44800/100000 (45%)]	Loss: 0.008890
Train Epoch: 6 [51200/100000 (51%)]	Loss: 0.050881
Train Epoch: 6 [57600/100000 (58%)]	Loss: 0.011869
Train Epoch: 6 [64000/100000 (64%)]	Loss: 0.037755
Train Epoch: 6 [70400/100000 (70%)]	Loss: 0.003349
Train Epoch: 6 [76800/100000 (77%)]	Loss: 0.065515
Train Epoch: 6 [83200/100000 (83%)]	Loss: 0.007823
Train Epoch: 6 [89600/100000 (90%)]	Loss: 0.008080
Train Epoch: 6 [96000/100000 (96%)]	Loss: 0.005342

Train set: Average loss: 0.0025, Accuracy: 99399/100000 (99.4%)


Test set test: Average loss: 1.4099, Accuracy: 7810/10000 (78.100%)

Test set test_counterfactual: Average loss: 1.4964, Accuracy: 7767/10000 (77.670%)

Test set test_counterfactual_rot: Average loss: 1.8276, Accuracy: 7297/10000 (72.970%)

Test set test_counterfactual_rot_scale: Average loss: 2.0520, Accuracy: 6993/10000 (69.930%)

Test set test_counterfactual_rot_scale_shear: Average loss: 2.6664, Accuracy: 6542/10000 (65.420%)
Train Epoch: 7 [0/100000 (0%)]	Loss: 0.013339
Train Epoch: 7 [6400/100000 (6%)]	Loss: 0.011023
Train Epoch: 7 [12800/100000 (13%)]	Loss: 0.016964
Train Epoch: 7 [19200/100000 (19%)]	Loss: 0.017585
Train Epoch: 7 [25600/100000 (26%)]	Loss: 0.010860
Train Epoch: 7 [32000/100000 (32%)]	Loss: 0.000929
Train Epoch: 7 [38400/100000 (38%)]	Loss: 0.012108
Train Epoch: 7 [44800/100000 (45%)]	Loss: 0.015577
Train Epoch: 7 [51200/100000 (51%)]	Loss: 0.002736
Train Epoch: 7 [57600/100000 (58%)]	Loss: 0.010974
Train Epoch: 7 [64000/100000 (64%)]	Loss: 0.038038
Train Epoch: 7 [70400/100000 (70%)]	Loss: 0.017883
Train Epoch: 7 [76800/100000 (77%)]	Loss: 0.014867
Train Epoch: 7 [83200/100000 (83%)]	Loss: 0.013004
Train Epoch: 7 [89600/100000 (90%)]	Loss: 0.007542
Train Epoch: 7 [96000/100000 (96%)]	Loss: 0.010030

Train set: Average loss: 0.0222, Accuracy: 99500/100000 (99.5%)


Test set test: Average loss: 1.4484, Accuracy: 7739/10000 (77.390%)

Test set test_counterfactual: Average loss: 1.5706, Accuracy: 7701/10000 (77.010%)

Test set test_counterfactual_rot: Average loss: 1.8591, Accuracy: 7277/10000 (72.770%)

Test set test_counterfactual_rot_scale: Average loss: 2.0874, Accuracy: 6957/10000 (69.570%)

Test set test_counterfactual_rot_scale_shear: Average loss: 2.6506, Accuracy: 6525/10000 (65.250%)
Train Epoch: 8 [0/100000 (0%)]	Loss: 0.005180
Train Epoch: 8 [6400/100000 (6%)]	Loss: 0.002875
Train Epoch: 8 [12800/100000 (13%)]	Loss: 0.012692
Train Epoch: 8 [19200/100000 (19%)]	Loss: 0.005771
Train Epoch: 8 [25600/100000 (26%)]	Loss: 0.001865
Train Epoch: 8 [32000/100000 (32%)]	Loss: 0.005009
Train Epoch: 8 [38400/100000 (38%)]	Loss: 0.005559
Train Epoch: 8 [44800/100000 (45%)]	Loss: 0.010462
Train Epoch: 8 [51200/100000 (51%)]	Loss: 0.004807
Train Epoch: 8 [57600/100000 (58%)]	Loss: 0.005594
Train Epoch: 8 [64000/100000 (64%)]	Loss: 0.016725
Train Epoch: 8 [70400/100000 (70%)]	Loss: 0.015369
Train Epoch: 8 [76800/100000 (77%)]	Loss: 0.002032
Train Epoch: 8 [83200/100000 (83%)]	Loss: 0.034661
Train Epoch: 8 [89600/100000 (90%)]	Loss: 0.003150
Train Epoch: 8 [96000/100000 (96%)]	Loss: 0.018695

Train set: Average loss: 0.0024, Accuracy: 99611/100000 (99.6%)


Test set test: Average loss: 1.4646, Accuracy: 7804/10000 (78.040%)

Test set test_counterfactual: Average loss: 1.5769, Accuracy: 7738/10000 (77.380%)

Test set test_counterfactual_rot: Average loss: 1.9167, Accuracy: 7299/10000 (72.990%)

Test set test_counterfactual_rot_scale: Average loss: 2.1395, Accuracy: 6979/10000 (69.790%)

Test set test_counterfactual_rot_scale_shear: Average loss: 2.7425, Accuracy: 6572/10000 (65.720%)
Train Epoch: 9 [0/100000 (0%)]	Loss: 0.000987
Train Epoch: 9 [6400/100000 (6%)]	Loss: 0.002204
Train Epoch: 9 [12800/100000 (13%)]	Loss: 0.022519
Train Epoch: 9 [19200/100000 (19%)]	Loss: 0.003511
Train Epoch: 9 [25600/100000 (26%)]	Loss: 0.034354
Train Epoch: 9 [32000/100000 (32%)]	Loss: 0.008999
Train Epoch: 9 [38400/100000 (38%)]	Loss: 0.003216
Train Epoch: 9 [44800/100000 (45%)]	Loss: 0.018796
Train Epoch: 9 [51200/100000 (51%)]	Loss: 0.028564
Train Epoch: 9 [57600/100000 (58%)]	Loss: 0.000685
Train Epoch: 9 [64000/100000 (64%)]	Loss: 0.009891
Train Epoch: 9 [70400/100000 (70%)]	Loss: 0.006563
Train Epoch: 9 [76800/100000 (77%)]	Loss: 0.012463
Train Epoch: 9 [83200/100000 (83%)]	Loss: 0.009935
Train Epoch: 9 [89600/100000 (90%)]	Loss: 0.002403
Train Epoch: 9 [96000/100000 (96%)]	Loss: 0.002261

Train set: Average loss: 0.0016, Accuracy: 99709/100000 (99.7%)


Test set test: Average loss: 1.4460, Accuracy: 7783/10000 (77.830%)

Test set test_counterfactual: Average loss: 1.5509, Accuracy: 7719/10000 (77.190%)

Test set test_counterfactual_rot: Average loss: 1.8350, Accuracy: 7313/10000 (73.130%)

Test set test_counterfactual_rot_scale: Average loss: 2.0512, Accuracy: 7000/10000 (70.000%)

Test set test_counterfactual_rot_scale_shear: Average loss: 2.6077, Accuracy: 6553/10000 (65.530%)
Train Epoch: 10 [0/100000 (0%)]	Loss: 0.016125
Train Epoch: 10 [6400/100000 (6%)]	Loss: 0.001996
Train Epoch: 10 [12800/100000 (13%)]	Loss: 0.002823
Train Epoch: 10 [19200/100000 (19%)]	Loss: 0.002872
Train Epoch: 10 [25600/100000 (26%)]	Loss: 0.010139
Train Epoch: 10 [32000/100000 (32%)]	Loss: 0.009744
Train Epoch: 10 [38400/100000 (38%)]	Loss: 0.004440
Train Epoch: 10 [44800/100000 (45%)]	Loss: 0.004658
Train Epoch: 10 [51200/100000 (51%)]	Loss: 0.006372
Train Epoch: 10 [57600/100000 (58%)]	Loss: 0.031339
Train Epoch: 10 [64000/100000 (64%)]	Loss: 0.009688
Train Epoch: 10 [70400/100000 (70%)]	Loss: 0.000812
Train Epoch: 10 [76800/100000 (77%)]	Loss: 0.002336
Train Epoch: 10 [83200/100000 (83%)]	Loss: 0.011404
Train Epoch: 10 [89600/100000 (90%)]	Loss: 0.001955
Train Epoch: 10 [96000/100000 (96%)]	Loss: 0.006881

Train set: Average loss: 0.0047, Accuracy: 99722/100000 (99.7%)


Test set test: Average loss: 1.5650, Accuracy: 7697/10000 (76.970%)

Test set test_counterfactual: Average loss: 1.6662, Accuracy: 7651/10000 (76.510%)

Test set test_counterfactual_rot: Average loss: 2.0112, Accuracy: 7220/10000 (72.200%)

Test set test_counterfactual_rot_scale: Average loss: 2.2421, Accuracy: 6919/10000 (69.190%)

Test set test_counterfactual_rot_scale_shear: Average loss: 2.8625, Accuracy: 6487/10000 (64.870%)
