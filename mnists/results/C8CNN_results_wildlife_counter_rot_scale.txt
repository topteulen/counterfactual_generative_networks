Train Epoch: 1 [0/100000 (0%)]  Loss: 2.414301
Train Epoch: 1 [6400/100000 (6%)]       Loss: 1.848984
Train Epoch: 1 [12800/100000 (13%)]     Loss: 1.411919
Train Epoch: 1 [19200/100000 (19%)]     Loss: 1.224786
Train Epoch: 1 [25600/100000 (26%)]     Loss: 1.101086
Train Epoch: 1 [32000/100000 (32%)]     Loss: 1.005498
Train Epoch: 1 [38400/100000 (38%)]     Loss: 0.790701
Train Epoch: 1 [44800/100000 (45%)]     Loss: 0.743737
Train Epoch: 1 [51200/100000 (51%)]     Loss: 0.712755
Train Epoch: 1 [57600/100000 (58%)]     Loss: 0.723116
Train Epoch: 1 [64000/100000 (64%)]     Loss: 0.519493
Train Epoch: 1 [70400/100000 (70%)]     Loss: 0.595470
Train Epoch: 1 [76800/100000 (77%)]     Loss: 0.545917
Train Epoch: 1 [83200/100000 (83%)]     Loss: 0.529601
Train Epoch: 1 [89600/100000 (90%)]     Loss: 0.514838
Train Epoch: 1 [96000/100000 (96%)]     Loss: 0.415141

Train set: Average loss: 0.6730, Accuracy: 68033/100000 (68.0%)


Test set test: Average loss: 7.9549, Accuracy: 3604/10000 (36.040%)

Test set test_counterfactual: Average loss: 9.3972, Accuracy: 3312/10000 (33.120%)

Test set test_counterfactual_rot: Average loss: 10.6345, Accuracy: 2694/10000 (26.940%)

Test set test_counterfactual_rot_scale: Average loss: 9.0337, Accuracy: 2766/10000 (27.660%)

Test set test_counterfactual_rot_scale_shear: Average loss: 9.9435, Accuracy: 2277/10000 (22.770%)
Train Epoch: 2 [0/100000 (0%)]  Loss: 0.538650
Train Epoch: 2 [6400/100000 (6%)]       Loss: 0.513468
Train Epoch: 2 [12800/100000 (13%)]     Loss: 0.359213
Train Epoch: 2 [19200/100000 (19%)]     Loss: 0.566979
Train Epoch: 2 [25600/100000 (26%)]     Loss: 0.330443
Train Epoch: 2 [32000/100000 (32%)]     Loss: 0.431979
Train Epoch: 2 [38400/100000 (38%)]     Loss: 0.288187
Train Epoch: 2 [44800/100000 (45%)]     Loss: 0.451338
Train Epoch: 2 [51200/100000 (51%)]     Loss: 0.407969
Train Epoch: 2 [57600/100000 (58%)]     Loss: 0.382401
Train Epoch: 2 [64000/100000 (64%)]     Loss: 0.242873
Train Epoch: 2 [70400/100000 (70%)]     Loss: 0.305271
Train Epoch: 2 [76800/100000 (77%)]     Loss: 0.384279
Train Epoch: 2 [83200/100000 (83%)]     Loss: 0.240872
Train Epoch: 2 [89600/100000 (90%)]     Loss: 0.264600
Train Epoch: 2 [96000/100000 (96%)]     Loss: 0.385582

Train set: Average loss: 0.3232, Accuracy: 88218/100000 (88.2%)


Test set test: Average loss: 18.5094, Accuracy: 3214/10000 (32.140%)

Test set test_counterfactual: Average loss: 22.0791, Accuracy: 3124/10000 (31.240%)

Test set test_counterfactual_rot: Average loss: 28.5839, Accuracy: 2148/10000 (21.480%)

Test set test_counterfactual_rot_scale: Average loss: 28.3969, Accuracy: 2081/10000 (20.810%)

Test set test_counterfactual_rot_scale_shear: Average loss: 31.6322, Accuracy: 1862/10000 (18.620%)
Train Epoch: 3 [0/100000 (0%)]  Loss: 0.194834
Train Epoch: 3 [6400/100000 (6%)]       Loss: 0.169298
Train Epoch: 3 [12800/100000 (13%)]     Loss: 0.321801
Train Epoch: 3 [19200/100000 (19%)]     Loss: 0.332358
Train Epoch: 3 [25600/100000 (26%)]     Loss: 0.111213
Train Epoch: 3 [32000/100000 (32%)]     Loss: 0.140385
Train Epoch: 3 [38400/100000 (38%)]     Loss: 0.187755
Train Epoch: 3 [44800/100000 (45%)]     Loss: 0.181506
Train Epoch: 3 [51200/100000 (51%)]     Loss: 0.234065
Train Epoch: 3 [57600/100000 (58%)]     Loss: 0.130025
Train Epoch: 3 [64000/100000 (64%)]     Loss: 0.119644
Train Epoch: 3 [70400/100000 (70%)]     Loss: 0.144113
Train Epoch: 3 [76800/100000 (77%)]     Loss: 0.219701
Train Epoch: 3 [83200/100000 (83%)]     Loss: 0.205290
Train Epoch: 3 [89600/100000 (90%)]     Loss: 0.149196
Train Epoch: 3 [96000/100000 (96%)]     Loss: 0.198952

Train set: Average loss: 0.2473, Accuracy: 94187/100000 (94.2%)


Test set test: Average loss: 23.2013, Accuracy: 3604/10000 (36.040%)

Test set test_counterfactual: Average loss: 23.3811, Accuracy: 3687/10000 (36.870%)

Test set test_counterfactual_rot: Average loss: 31.2178, Accuracy: 2418/10000 (24.180%)

Test set test_counterfactual_rot_scale: Average loss: 31.6863, Accuracy: 2307/10000 (23.070%)

Test set test_counterfactual_rot_scale_shear: Average loss: 33.9041, Accuracy: 2265/10000 (22.650%)
Train Epoch: 4 [0/100000 (0%)]  Loss: 0.030955
Train Epoch: 4 [6400/100000 (6%)]       Loss: 0.053943
Train Epoch: 4 [12800/100000 (13%)]     Loss: 0.040003
Train Epoch: 4 [19200/100000 (19%)]     Loss: 0.137100
Train Epoch: 4 [25600/100000 (26%)]     Loss: 0.257554
Train Epoch: 4 [32000/100000 (32%)]     Loss: 0.124011
Train Epoch: 4 [38400/100000 (38%)]     Loss: 0.050007
Train Epoch: 4 [44800/100000 (45%)]     Loss: 0.101797
Train Epoch: 4 [51200/100000 (51%)]     Loss: 0.088523
Train Epoch: 4 [57600/100000 (58%)]     Loss: 0.139793
Train Epoch: 4 [64000/100000 (64%)]     Loss: 0.056095
Train Epoch: 4 [70400/100000 (70%)]     Loss: 0.063642
Train Epoch: 4 [76800/100000 (77%)]     Loss: 0.247998
Train Epoch: 4 [83200/100000 (83%)]     Loss: 0.032122
Train Epoch: 4 [89600/100000 (90%)]     Loss: 0.079804
Train Epoch: 4 [96000/100000 (96%)]     Loss: 0.056854

Train set: Average loss: 0.0429, Accuracy: 97170/100000 (97.2%)


Test set test: Average loss: 15.6921, Accuracy: 3006/10000 (30.060%)

Test set test_counterfactual: Average loss: 17.6185, Accuracy: 2685/10000 (26.850%)

Test set test_counterfactual_rot: Average loss: 20.4594, Accuracy: 1798/10000 (17.980%)

Test set test_counterfactual_rot_scale: Average loss: 19.8226, Accuracy: 1851/10000 (18.510%)

Test set test_counterfactual_rot_scale_shear: Average loss: 22.4350, Accuracy: 1845/10000 (18.450%)
Train Epoch: 5 [0/100000 (0%)]  Loss: 0.074642
Train Epoch: 5 [6400/100000 (6%)]       Loss: 0.036656
Train Epoch: 5 [12800/100000 (13%)]     Loss: 0.027128
Train Epoch: 5 [19200/100000 (19%)]     Loss: 0.002211
Train Epoch: 5 [25600/100000 (26%)]     Loss: 0.017538
Train Epoch: 5 [32000/100000 (32%)]     Loss: 0.024312
Train Epoch: 5 [38400/100000 (38%)]     Loss: 0.007169
Train Epoch: 5 [44800/100000 (45%)]     Loss: 0.098365
Train Epoch: 5 [51200/100000 (51%)]     Loss: 0.029009
Train Epoch: 5 [57600/100000 (58%)]     Loss: 0.016133
Train Epoch: 5 [64000/100000 (64%)]     Loss: 0.083138
Train Epoch: 5 [70400/100000 (70%)]     Loss: 0.003403
Train Epoch: 5 [76800/100000 (77%)]     Loss: 0.008638
Train Epoch: 5 [83200/100000 (83%)]     Loss: 0.017161
Train Epoch: 5 [89600/100000 (90%)]     Loss: 0.007278
Train Epoch: 5 [96000/100000 (96%)]     Loss: 0.003992

Train set: Average loss: 0.0063, Accuracy: 98856/100000 (98.9%)


Test set test: Average loss: 17.0937, Accuracy: 2808/10000 (28.080%)

Test set test_counterfactual: Average loss: 16.6223, Accuracy: 2682/10000 (26.820%)

Test set test_counterfactual_rot: Average loss: 21.2036, Accuracy: 1846/10000 (18.460%)

Test set test_counterfactual_rot_scale: Average loss: 23.0353, Accuracy: 1959/10000 (19.590%)

Test set test_counterfactual_rot_scale_shear: Average loss: 23.8518, Accuracy: 1918/10000 (19.180%)
Train Epoch: 6 [0/100000 (0%)]  Loss: 0.016485
Train Epoch: 6 [6400/100000 (6%)]       Loss: 0.021008
Train Epoch: 6 [12800/100000 (13%)]     Loss: 0.008617
Train Epoch: 6 [19200/100000 (19%)]     Loss: 0.004497
Train Epoch: 6 [25600/100000 (26%)]     Loss: 0.002037
Train Epoch: 6 [32000/100000 (32%)]     Loss: 0.001311
Train Epoch: 6 [38400/100000 (38%)]     Loss: 0.007025
Train Epoch: 6 [44800/100000 (45%)]     Loss: 0.002742
Train Epoch: 6 [51200/100000 (51%)]     Loss: 0.033597
Train Epoch: 6 [57600/100000 (58%)]     Loss: 0.004091
Train Epoch: 6 [64000/100000 (64%)]     Loss: 0.007097
Train Epoch: 6 [70400/100000 (70%)]     Loss: 0.017339
Train Epoch: 6 [76800/100000 (77%)]     Loss: 0.003008
Train Epoch: 6 [83200/100000 (83%)]     Loss: 0.004293
Train Epoch: 6 [89600/100000 (90%)]     Loss: 0.047357
Train Epoch: 6 [96000/100000 (96%)]     Loss: 0.003069

Train set: Average loss: 0.0193, Accuracy: 99624/100000 (99.6%)


Test set test: Average loss: 15.1935, Accuracy: 2219/10000 (22.190%)

Test set test_counterfactual: Average loss: 15.0679, Accuracy: 2059/10000 (20.590%)

Test set test_counterfactual_rot: Average loss: 16.0816, Accuracy: 1514/10000 (15.140%)

Test set test_counterfactual_rot_scale: Average loss: 16.5266, Accuracy: 1598/10000 (15.980%)

Test set test_counterfactual_rot_scale_shear: Average loss: 17.7280, Accuracy: 1573/10000 (15.730%)
Train Epoch: 7 [0/100000 (0%)]  Loss: 0.004240
Train Epoch: 7 [6400/100000 (6%)]       Loss: 0.004862
Train Epoch: 7 [12800/100000 (13%)]     Loss: 0.006934
Train Epoch: 7 [19200/100000 (19%)]     Loss: 0.001559
Train Epoch: 7 [25600/100000 (26%)]     Loss: 0.009336
Train Epoch: 7 [32000/100000 (32%)]     Loss: 0.000901
Train Epoch: 7 [38400/100000 (38%)]     Loss: 0.002358
Train Epoch: 7 [44800/100000 (45%)]     Loss: 0.006140
Train Epoch: 7 [51200/100000 (51%)]     Loss: 0.002193
Train Epoch: 7 [57600/100000 (58%)]     Loss: 0.011170
Train Epoch: 7 [64000/100000 (64%)]     Loss: 0.003412
Train Epoch: 7 [70400/100000 (70%)]     Loss: 0.003752
Train Epoch: 7 [76800/100000 (77%)]     Loss: 0.001458
Train Epoch: 7 [83200/100000 (83%)]     Loss: 0.027337
Train Epoch: 7 [89600/100000 (90%)]     Loss: 0.031550
Train Epoch: 7 [96000/100000 (96%)]     Loss: 0.006259

Train set: Average loss: 0.0544, Accuracy: 99891/100000 (99.9%)


Test set test: Average loss: 12.7533, Accuracy: 2400/10000 (24.000%)

Test set test_counterfactual: Average loss: 12.5920, Accuracy: 2349/10000 (23.490%)

Test set test_counterfactual_rot: Average loss: 14.4902, Accuracy: 1634/10000 (16.340%)

Test set test_counterfactual_rot_scale: Average loss: 14.7568, Accuracy: 1580/10000 (15.800%)

Test set test_counterfactual_rot_scale_shear: Average loss: 15.5280, Accuracy: 1625/10000 (16.250%)
Train Epoch: 8 [0/100000 (0%)]  Loss: 0.006590
Train Epoch: 8 [6400/100000 (6%)]       Loss: 0.001203
Train Epoch: 8 [12800/100000 (13%)]     Loss: 0.026560
Train Epoch: 8 [19200/100000 (19%)]     Loss: 0.018645
Train Epoch: 8 [25600/100000 (26%)]     Loss: 0.002337
Train Epoch: 8 [32000/100000 (32%)]     Loss: 0.009414
Train Epoch: 8 [38400/100000 (38%)]     Loss: 0.002476
Train Epoch: 8 [44800/100000 (45%)]     Loss: 0.000468
Train Epoch: 8 [51200/100000 (51%)]     Loss: 0.001823
Train Epoch: 8 [57600/100000 (58%)]     Loss: 0.000098
Train Epoch: 8 [64000/100000 (64%)]     Loss: 0.005356
Train Epoch: 8 [70400/100000 (70%)]     Loss: 0.003446
Train Epoch: 8 [76800/100000 (77%)]     Loss: 0.013598
Train Epoch: 8 [83200/100000 (83%)]     Loss: 0.001904
Train Epoch: 8 [89600/100000 (90%)]     Loss: 0.001247
Train Epoch: 8 [96000/100000 (96%)]     Loss: 0.007798

Train set: Average loss: 0.0241, Accuracy: 99944/100000 (99.9%)


Test set test: Average loss: 13.9298, Accuracy: 2145/10000 (21.450%)

Test set test_counterfactual: Average loss: 13.4180, Accuracy: 2079/10000 (20.790%)

Test set test_counterfactual_rot: Average loss: 14.3352, Accuracy: 1508/10000 (15.080%)

Test set test_counterfactual_rot_scale: Average loss: 14.4535, Accuracy: 1528/10000 (15.280%)

Test set test_counterfactual_rot_scale_shear: Average loss: 15.2862, Accuracy: 1532/10000 (15.320%)
Train Epoch: 9 [0/100000 (0%)]  Loss: 0.000856
Train Epoch: 9 [6400/100000 (6%)]       Loss: 0.002154
Train Epoch: 9 [12800/100000 (13%)]     Loss: 0.000894
Train Epoch: 9 [19200/100000 (19%)]     Loss: 0.000820
Train Epoch: 9 [25600/100000 (26%)]     Loss: 0.000783
Train Epoch: 9 [32000/100000 (32%)]     Loss: 0.001536
Train Epoch: 9 [38400/100000 (38%)]     Loss: 0.001460
Train Epoch: 9 [44800/100000 (45%)]     Loss: 0.000610
Train Epoch: 9 [51200/100000 (51%)]     Loss: 0.000263
Train Epoch: 9 [57600/100000 (58%)]     Loss: 0.002791
Train Epoch: 9 [64000/100000 (64%)]     Loss: 0.000743
Train Epoch: 9 [70400/100000 (70%)]     Loss: 0.007317
Train Epoch: 9 [76800/100000 (77%)]     Loss: 0.003228
Train Epoch: 9 [83200/100000 (83%)]     Loss: 0.000538
Train Epoch: 9 [89600/100000 (90%)]     Loss: 0.004469
Train Epoch: 9 [96000/100000 (96%)]     Loss: 0.007893

Train set: Average loss: 0.0002, Accuracy: 99975/100000 (100.0%)


Test set test: Average loss: 13.4275, Accuracy: 2138/10000 (21.380%)

Test set test_counterfactual: Average loss: 12.9278, Accuracy: 2081/10000 (20.810%)

Test set test_counterfactual_rot: Average loss: 13.7756, Accuracy: 1483/10000 (14.830%)

Test set test_counterfactual_rot_scale: Average loss: 13.4799, Accuracy: 1496/10000 (14.960%)

Test set test_counterfactual_rot_scale_shear: Average loss: 14.4458, Accuracy: 1509/10000 (15.090%)
Train Epoch: 10 [0/100000 (0%)] Loss: 0.000216
Train Epoch: 10 [6400/100000 (6%)]      Loss: 0.000869
Train Epoch: 10 [12800/100000 (13%)]    Loss: 0.001493
Train Epoch: 10 [19200/100000 (19%)]    Loss: 0.000451
Train Epoch: 10 [25600/100000 (26%)]    Loss: 0.000930
Train Epoch: 10 [32000/100000 (32%)]    Loss: 0.000772
Train Epoch: 10 [38400/100000 (38%)]    Loss: 0.000797
Train Epoch: 10 [44800/100000 (45%)]    Loss: 0.000815
Train Epoch: 10 [51200/100000 (51%)]    Loss: 0.020520
Train Epoch: 10 [57600/100000 (58%)]    Loss: 0.000634
Train Epoch: 10 [64000/100000 (64%)]    Loss: 0.005923
Train Epoch: 10 [70400/100000 (70%)]    Loss: 0.000701
Train Epoch: 10 [76800/100000 (77%)]    Loss: 0.000866
Train Epoch: 10 [83200/100000 (83%)]    Loss: 0.003700
Train Epoch: 10 [89600/100000 (90%)]    Loss: 0.001396
Train Epoch: 10 [96000/100000 (96%)]    Loss: 0.006400

Train set: Average loss: 0.0002, Accuracy: 99982/100000 (100.0%)


Test set test: Average loss: 14.0228, Accuracy: 2175/10000 (21.750%)

Test set test_counterfactual: Average loss: 13.2684, Accuracy: 2006/10000 (20.060%)

Test set test_counterfactual_rot: Average loss: 13.9765, Accuracy: 1464/10000 (14.640%)

Test set test_counterfactual_rot_scale: Average loss: 14.0753, Accuracy: 1499/10000 (14.990%)

Test set test_counterfactual_rot_scale_shear: Average loss: 14.9050, Accuracy: 1511/10000 (15.110%)