Namespace(dataset='colored_MNIST_counterfactual_rot_scale_shear', batch_size=64, epochs=10, lr=1.0, gamma=0.7, log_interval=100, model='SES')

Number of trainable parameters: 619285

Train Epoch: 1 [0/100000 (0%)]	Loss: 2.651413
Train Epoch: 1 [6400/100000 (6%)]	Loss: 1.870922
Train Epoch: 1 [12800/100000 (13%)]	Loss: 1.615097
Train Epoch: 1 [19200/100000 (19%)]	Loss: 1.348941
Train Epoch: 1 [25600/100000 (26%)]	Loss: 1.170337
Train Epoch: 1 [32000/100000 (32%)]	Loss: 0.857842
Train Epoch: 1 [38400/100000 (38%)]	Loss: 1.057019
Train Epoch: 1 [44800/100000 (45%)]	Loss: 0.694609
Train Epoch: 1 [51200/100000 (51%)]	Loss: 0.988608
Train Epoch: 1 [57600/100000 (58%)]	Loss: 0.666292
Train Epoch: 1 [64000/100000 (64%)]	Loss: 0.888613
Train Epoch: 1 [70400/100000 (70%)]	Loss: 0.604803
Train Epoch: 1 [76800/100000 (77%)]	Loss: 0.727492
Train Epoch: 1 [83200/100000 (83%)]	Loss: 0.512844
Train Epoch: 1 [89600/100000 (90%)]	Loss: 0.645147
Train Epoch: 1 [96000/100000 (96%)]	Loss: 0.659755

Train set: Average loss: 0.5102, Accuracy: 63434/100000 (63.4%)


Test set test: Average loss: 0.6788, Accuracy: 7923/10000 (79.230%)

Test set test_counterfactual: Average loss: 0.7460, Accuracy: 7647/10000 (76.470%)

Test set test_counterfactual_rot: Average loss: 0.8046, Accuracy: 7452/10000 (74.520%)

Test set test_counterfactual_rot_scale: Average loss: 0.9619, Accuracy: 7024/10000 (70.240%)

Test set test_counterfactual_rot_scale_shear: Average loss: 1.0753, Accuracy: 6779/10000 (67.790%)
Train Epoch: 2 [0/100000 (0%)]	Loss: 0.398799
Train Epoch: 2 [6400/100000 (6%)]	Loss: 0.338702
Train Epoch: 2 [12800/100000 (13%)]	Loss: 0.483114
Train Epoch: 2 [19200/100000 (19%)]	Loss: 0.287896
Train Epoch: 2 [25600/100000 (26%)]	Loss: 0.342471
Train Epoch: 2 [32000/100000 (32%)]	Loss: 0.485301
Train Epoch: 2 [38400/100000 (38%)]	Loss: 0.408345
Train Epoch: 2 [44800/100000 (45%)]	Loss: 0.298273
Train Epoch: 2 [51200/100000 (51%)]	Loss: 0.148916
Train Epoch: 2 [57600/100000 (58%)]	Loss: 0.104510
Train Epoch: 2 [64000/100000 (64%)]	Loss: 0.347708
Train Epoch: 2 [70400/100000 (70%)]	Loss: 0.218860
Train Epoch: 2 [76800/100000 (77%)]	Loss: 0.325105
Train Epoch: 2 [83200/100000 (83%)]	Loss: 0.088336
Train Epoch: 2 [89600/100000 (90%)]	Loss: 0.289344
Train Epoch: 2 [96000/100000 (96%)]	Loss: 0.280050

Train set: Average loss: 0.2141, Accuracy: 89017/100000 (89.0%)


Test set test: Average loss: 0.9812, Accuracy: 7714/10000 (77.140%)

Test set test_counterfactual: Average loss: 1.0861, Accuracy: 7617/10000 (76.170%)

Test set test_counterfactual_rot: Average loss: 1.0752, Accuracy: 7518/10000 (75.180%)

Test set test_counterfactual_rot_scale: Average loss: 1.2133, Accuracy: 7142/10000 (71.420%)

Test set test_counterfactual_rot_scale_shear: Average loss: 1.3619, Accuracy: 6902/10000 (69.020%)
Train Epoch: 3 [0/100000 (0%)]	Loss: 0.160418
Train Epoch: 3 [6400/100000 (6%)]	Loss: 0.218909
Train Epoch: 3 [12800/100000 (13%)]	Loss: 0.116475
Train Epoch: 3 [19200/100000 (19%)]	Loss: 0.253246
Train Epoch: 3 [25600/100000 (26%)]	Loss: 0.037977
Train Epoch: 3 [32000/100000 (32%)]	Loss: 0.065097
Train Epoch: 3 [38400/100000 (38%)]	Loss: 0.080413
Train Epoch: 3 [44800/100000 (45%)]	Loss: 0.071499
Train Epoch: 3 [51200/100000 (51%)]	Loss: 0.218005
Train Epoch: 3 [57600/100000 (58%)]	Loss: 0.184149
Train Epoch: 3 [64000/100000 (64%)]	Loss: 0.106830
Train Epoch: 3 [70400/100000 (70%)]	Loss: 0.289649
Train Epoch: 3 [76800/100000 (77%)]	Loss: 0.054527
Train Epoch: 3 [83200/100000 (83%)]	Loss: 0.170081
Train Epoch: 3 [89600/100000 (90%)]	Loss: 0.077881
Train Epoch: 3 [96000/100000 (96%)]	Loss: 0.110594

Train set: Average loss: 0.1853, Accuracy: 95504/100000 (95.5%)


Test set test: Average loss: 1.1116, Accuracy: 8070/10000 (80.700%)

Test set test_counterfactual: Average loss: 1.2419, Accuracy: 7891/10000 (78.910%)

Test set test_counterfactual_rot: Average loss: 1.5611, Accuracy: 7403/10000 (74.030%)

Test set test_counterfactual_rot_scale: Average loss: 1.8059, Accuracy: 6940/10000 (69.400%)

Test set test_counterfactual_rot_scale_shear: Average loss: 2.0886, Accuracy: 6672/10000 (66.720%)
Train Epoch: 4 [0/100000 (0%)]	Loss: 0.096965
Train Epoch: 4 [6400/100000 (6%)]	Loss: 0.067930
Train Epoch: 4 [12800/100000 (13%)]	Loss: 0.165521
Train Epoch: 4 [19200/100000 (19%)]	Loss: 0.076878
Train Epoch: 4 [25600/100000 (26%)]	Loss: 0.058306
Train Epoch: 4 [32000/100000 (32%)]	Loss: 0.013438
Train Epoch: 4 [38400/100000 (38%)]	Loss: 0.089802
Train Epoch: 4 [44800/100000 (45%)]	Loss: 0.152055
Train Epoch: 4 [51200/100000 (51%)]	Loss: 0.078456
Train Epoch: 4 [57600/100000 (58%)]	Loss: 0.108698
Train Epoch: 4 [64000/100000 (64%)]	Loss: 0.040029
Train Epoch: 4 [70400/100000 (70%)]	Loss: 0.042940
Train Epoch: 4 [76800/100000 (77%)]	Loss: 0.009544
Train Epoch: 4 [83200/100000 (83%)]	Loss: 0.064524
Train Epoch: 4 [89600/100000 (90%)]	Loss: 0.068554
Train Epoch: 4 [96000/100000 (96%)]	Loss: 0.123227

Train set: Average loss: 0.0061, Accuracy: 97783/100000 (97.8%)


Test set test: Average loss: 1.1325, Accuracy: 8061/10000 (80.610%)

Test set test_counterfactual: Average loss: 1.2624, Accuracy: 7711/10000 (77.110%)

Test set test_counterfactual_rot: Average loss: 1.4824, Accuracy: 7500/10000 (75.000%)

Test set test_counterfactual_rot_scale: Average loss: 1.7021, Accuracy: 7079/10000 (70.790%)

Test set test_counterfactual_rot_scale_shear: Average loss: 1.9464, Accuracy: 6821/10000 (68.210%)
Train Epoch: 5 [0/100000 (0%)]	Loss: 0.035503
Train Epoch: 5 [6400/100000 (6%)]	Loss: 0.031241
Train Epoch: 5 [12800/100000 (13%)]	Loss: 0.055577
Train Epoch: 5 [19200/100000 (19%)]	Loss: 0.045515
Train Epoch: 5 [25600/100000 (26%)]	Loss: 0.014712
Train Epoch: 5 [32000/100000 (32%)]	Loss: 0.023781
Train Epoch: 5 [38400/100000 (38%)]	Loss: 0.018543
Train Epoch: 5 [44800/100000 (45%)]	Loss: 0.041482
Train Epoch: 5 [51200/100000 (51%)]	Loss: 0.019135
Train Epoch: 5 [57600/100000 (58%)]	Loss: 0.177110
Train Epoch: 5 [64000/100000 (64%)]	Loss: 0.030994
Train Epoch: 5 [70400/100000 (70%)]	Loss: 0.006041
Train Epoch: 5 [76800/100000 (77%)]	Loss: 0.067520
Train Epoch: 5 [83200/100000 (83%)]	Loss: 0.013491
Train Epoch: 5 [89600/100000 (90%)]	Loss: 0.036399
Train Epoch: 5 [96000/100000 (96%)]	Loss: 0.029311

Train set: Average loss: 0.0232, Accuracy: 98692/100000 (98.7%)


Test set test: Average loss: 1.3431, Accuracy: 7815/10000 (78.150%)

Test set test_counterfactual: Average loss: 1.4499, Accuracy: 7676/10000 (76.760%)

Test set test_counterfactual_rot: Average loss: 1.6787, Accuracy: 7347/10000 (73.470%)

Test set test_counterfactual_rot_scale: Average loss: 1.9597, Accuracy: 6980/10000 (69.800%)

Test set test_counterfactual_rot_scale_shear: Average loss: 2.2569, Accuracy: 6683/10000 (66.830%)
Train Epoch: 6 [0/100000 (0%)]	Loss: 0.017451
Train Epoch: 6 [6400/100000 (6%)]	Loss: 0.043429
Train Epoch: 6 [12800/100000 (13%)]	Loss: 0.004975
Train Epoch: 6 [19200/100000 (19%)]	Loss: 0.032886
Train Epoch: 6 [25600/100000 (26%)]	Loss: 0.007801
Train Epoch: 6 [32000/100000 (32%)]	Loss: 0.010812
Train Epoch: 6 [38400/100000 (38%)]	Loss: 0.087281
Train Epoch: 6 [44800/100000 (45%)]	Loss: 0.004542
Train Epoch: 6 [51200/100000 (51%)]	Loss: 0.016871
Train Epoch: 6 [57600/100000 (58%)]	Loss: 0.006940
Train Epoch: 6 [64000/100000 (64%)]	Loss: 0.021855
Train Epoch: 6 [70400/100000 (70%)]	Loss: 0.038651
Train Epoch: 6 [76800/100000 (77%)]	Loss: 0.030002
Train Epoch: 6 [83200/100000 (83%)]	Loss: 0.005206
Train Epoch: 6 [89600/100000 (90%)]	Loss: 0.008854
Train Epoch: 6 [96000/100000 (96%)]	Loss: 0.018526

Train set: Average loss: 0.0277, Accuracy: 99210/100000 (99.2%)


Test set test: Average loss: 1.3263, Accuracy: 8015/10000 (80.150%)

Test set test_counterfactual: Average loss: 1.3786, Accuracy: 7840/10000 (78.400%)

Test set test_counterfactual_rot: Average loss: 1.6624, Accuracy: 7503/10000 (75.030%)

Test set test_counterfactual_rot_scale: Average loss: 1.9831, Accuracy: 7060/10000 (70.600%)

Test set test_counterfactual_rot_scale_shear: Average loss: 2.2570, Accuracy: 6794/10000 (67.940%)
Train Epoch: 7 [0/100000 (0%)]	Loss: 0.079565
Train Epoch: 7 [6400/100000 (6%)]	Loss: 0.018979
Train Epoch: 7 [12800/100000 (13%)]	Loss: 0.055496
Train Epoch: 7 [19200/100000 (19%)]	Loss: 0.004391
Train Epoch: 7 [25600/100000 (26%)]	Loss: 0.042134
Train Epoch: 7 [32000/100000 (32%)]	Loss: 0.004116
Train Epoch: 7 [38400/100000 (38%)]	Loss: 0.026076
Train Epoch: 7 [44800/100000 (45%)]	Loss: 0.001247
Train Epoch: 7 [51200/100000 (51%)]	Loss: 0.005363
Train Epoch: 7 [57600/100000 (58%)]	Loss: 0.033288
Train Epoch: 7 [64000/100000 (64%)]	Loss: 0.002509
Train Epoch: 7 [70400/100000 (70%)]	Loss: 0.015145
Train Epoch: 7 [76800/100000 (77%)]	Loss: 0.017023
Train Epoch: 7 [83200/100000 (83%)]	Loss: 0.015137
Train Epoch: 7 [89600/100000 (90%)]	Loss: 0.012605
Train Epoch: 7 [96000/100000 (96%)]	Loss: 0.002706

Train set: Average loss: 0.2063, Accuracy: 99407/100000 (99.4%)


Test set test: Average loss: 1.2949, Accuracy: 8010/10000 (80.100%)

Test set test_counterfactual: Average loss: 1.3311, Accuracy: 7888/10000 (78.880%)

Test set test_counterfactual_rot: Average loss: 1.5825, Accuracy: 7539/10000 (75.390%)

Test set test_counterfactual_rot_scale: Average loss: 1.8538, Accuracy: 7121/10000 (71.210%)

Test set test_counterfactual_rot_scale_shear: Average loss: 2.1232, Accuracy: 6834/10000 (68.340%)
Train Epoch: 8 [0/100000 (0%)]	Loss: 0.015176
Train Epoch: 8 [6400/100000 (6%)]	Loss: 0.010043
Train Epoch: 8 [12800/100000 (13%)]	Loss: 0.026040
Train Epoch: 8 [19200/100000 (19%)]	Loss: 0.009133
Train Epoch: 8 [25600/100000 (26%)]	Loss: 0.009553
Train Epoch: 8 [32000/100000 (32%)]	Loss: 0.023759
Train Epoch: 8 [38400/100000 (38%)]	Loss: 0.011093
Train Epoch: 8 [44800/100000 (45%)]	Loss: 0.004925
Train Epoch: 8 [51200/100000 (51%)]	Loss: 0.019266
Train Epoch: 8 [57600/100000 (58%)]	Loss: 0.001799
Train Epoch: 8 [64000/100000 (64%)]	Loss: 0.005447
Train Epoch: 8 [70400/100000 (70%)]	Loss: 0.045460
Train Epoch: 8 [76800/100000 (77%)]	Loss: 0.007188
Train Epoch: 8 [83200/100000 (83%)]	Loss: 0.004244
Train Epoch: 8 [89600/100000 (90%)]	Loss: 0.005765
Train Epoch: 8 [96000/100000 (96%)]	Loss: 0.008612

Train set: Average loss: 0.0115, Accuracy: 99536/100000 (99.5%)


Test set test: Average loss: 1.3866, Accuracy: 7956/10000 (79.560%)

Test set test_counterfactual: Average loss: 1.4539, Accuracy: 7823/10000 (78.230%)

Test set test_counterfactual_rot: Average loss: 1.6993, Accuracy: 7537/10000 (75.370%)

Test set test_counterfactual_rot_scale: Average loss: 1.9925, Accuracy: 7129/10000 (71.290%)

Test set test_counterfactual_rot_scale_shear: Average loss: 2.3027, Accuracy: 6782/10000 (67.820%)
Train Epoch: 9 [0/100000 (0%)]	Loss: 0.056685
Train Epoch: 9 [6400/100000 (6%)]	Loss: 0.002490
Train Epoch: 9 [12800/100000 (13%)]	Loss: 0.000810
Train Epoch: 9 [19200/100000 (19%)]	Loss: 0.001242
Train Epoch: 9 [25600/100000 (26%)]	Loss: 0.003748
Train Epoch: 9 [32000/100000 (32%)]	Loss: 0.009677
Train Epoch: 9 [38400/100000 (38%)]	Loss: 0.001441
Train Epoch: 9 [44800/100000 (45%)]	Loss: 0.003146
Train Epoch: 9 [51200/100000 (51%)]	Loss: 0.005090
Train Epoch: 9 [57600/100000 (58%)]	Loss: 0.075266
Train Epoch: 9 [64000/100000 (64%)]	Loss: 0.004087
Train Epoch: 9 [70400/100000 (70%)]	Loss: 0.001373
Train Epoch: 9 [76800/100000 (77%)]	Loss: 0.014015
Train Epoch: 9 [83200/100000 (83%)]	Loss: 0.038987
Train Epoch: 9 [89600/100000 (90%)]	Loss: 0.027886
Train Epoch: 9 [96000/100000 (96%)]	Loss: 0.031962

Train set: Average loss: 0.0050, Accuracy: 99586/100000 (99.6%)


Test set test: Average loss: 1.3515, Accuracy: 8052/10000 (80.520%)

Test set test_counterfactual: Average loss: 1.4490, Accuracy: 7844/10000 (78.440%)

Test set test_counterfactual_rot: Average loss: 1.7469, Accuracy: 7522/10000 (75.220%)

Test set test_counterfactual_rot_scale: Average loss: 2.0399, Accuracy: 7111/10000 (71.110%)

Test set test_counterfactual_rot_scale_shear: Average loss: 2.3485, Accuracy: 6782/10000 (67.820%)
Train Epoch: 10 [0/100000 (0%)]	Loss: 0.003520
Train Epoch: 10 [6400/100000 (6%)]	Loss: 0.001228
Train Epoch: 10 [12800/100000 (13%)]	Loss: 0.014967
Train Epoch: 10 [19200/100000 (19%)]	Loss: 0.017147
Train Epoch: 10 [25600/100000 (26%)]	Loss: 0.006201
Train Epoch: 10 [32000/100000 (32%)]	Loss: 0.053256
Train Epoch: 10 [38400/100000 (38%)]	Loss: 0.037969
Train Epoch: 10 [44800/100000 (45%)]	Loss: 0.010257
Train Epoch: 10 [51200/100000 (51%)]	Loss: 0.007926
Train Epoch: 10 [57600/100000 (58%)]	Loss: 0.013252
Train Epoch: 10 [64000/100000 (64%)]	Loss: 0.030886
Train Epoch: 10 [70400/100000 (70%)]	Loss: 0.004941
Train Epoch: 10 [76800/100000 (77%)]	Loss: 0.000903
Train Epoch: 10 [83200/100000 (83%)]	Loss: 0.048312
Train Epoch: 10 [89600/100000 (90%)]	Loss: 0.007083
Train Epoch: 10 [96000/100000 (96%)]	Loss: 0.002350

Train set: Average loss: 0.1376, Accuracy: 99634/100000 (99.6%)


Test set test: Average loss: 1.3984, Accuracy: 8002/10000 (80.020%)

Test set test_counterfactual: Average loss: 1.4880, Accuracy: 7787/10000 (77.870%)

Test set test_counterfactual_rot: Average loss: 1.7499, Accuracy: 7517/10000 (75.170%)

Test set test_counterfactual_rot_scale: Average loss: 2.0474, Accuracy: 7110/10000 (71.100%)

Test set test_counterfactual_rot_scale_shear: Average loss: 2.3652, Accuracy: 6785/10000 (67.850%)
