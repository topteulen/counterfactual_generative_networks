Namespace(dataset='colored_MNIST_counterfactual_rot_scale', batch_size=64, epochs=10, lr=1.0, gamma=0.7, log_interval=100, model='SES')

Number of trainable parameters: 619285

Train Epoch: 1 [0/100000 (0%)]	Loss: 2.499172
Train Epoch: 1 [6400/100000 (6%)]	Loss: 1.651217
Train Epoch: 1 [12800/100000 (13%)]	Loss: 1.414427
Train Epoch: 1 [19200/100000 (19%)]	Loss: 1.301254
Train Epoch: 1 [25600/100000 (26%)]	Loss: 1.066416
Train Epoch: 1 [32000/100000 (32%)]	Loss: 1.172110
Train Epoch: 1 [38400/100000 (38%)]	Loss: 0.746933
Train Epoch: 1 [44800/100000 (45%)]	Loss: 0.707807
Train Epoch: 1 [51200/100000 (51%)]	Loss: 0.775281
Train Epoch: 1 [57600/100000 (58%)]	Loss: 1.272849
Train Epoch: 1 [64000/100000 (64%)]	Loss: 0.805038
Train Epoch: 1 [70400/100000 (70%)]	Loss: 0.665530
Train Epoch: 1 [76800/100000 (77%)]	Loss: 0.603597
Train Epoch: 1 [83200/100000 (83%)]	Loss: 0.659039
Train Epoch: 1 [89600/100000 (90%)]	Loss: 0.712357
Train Epoch: 1 [96000/100000 (96%)]	Loss: 0.328089

Train set: Average loss: 0.4424, Accuracy: 67098/100000 (67.1%)


Test set test: Average loss: 0.7651, Accuracy: 7503/10000 (75.030%)

Test set test_counterfactual: Average loss: 0.8607, Accuracy: 7312/10000 (73.120%)

Test set test_counterfactual_rot: Average loss: 0.9102, Accuracy: 7251/10000 (72.510%)

Test set test_counterfactual_rot_scale: Average loss: 1.0232, Accuracy: 6952/10000 (69.520%)

Test set test_counterfactual_rot_scale_shear: Average loss: 1.2530, Accuracy: 6516/10000 (65.160%)
Train Epoch: 2 [0/100000 (0%)]	Loss: 0.307560
Train Epoch: 2 [6400/100000 (6%)]	Loss: 0.397982
Train Epoch: 2 [12800/100000 (13%)]	Loss: 0.279960
Train Epoch: 2 [19200/100000 (19%)]	Loss: 0.365119
Train Epoch: 2 [25600/100000 (26%)]	Loss: 0.490292
Train Epoch: 2 [32000/100000 (32%)]	Loss: 0.234866
Train Epoch: 2 [38400/100000 (38%)]	Loss: 0.222196
Train Epoch: 2 [44800/100000 (45%)]	Loss: 0.259592
Train Epoch: 2 [51200/100000 (51%)]	Loss: 0.131590
Train Epoch: 2 [57600/100000 (58%)]	Loss: 0.354063
Train Epoch: 2 [64000/100000 (64%)]	Loss: 0.314789
Train Epoch: 2 [70400/100000 (70%)]	Loss: 0.452315
Train Epoch: 2 [76800/100000 (77%)]	Loss: 0.195979
Train Epoch: 2 [83200/100000 (83%)]	Loss: 0.225716
Train Epoch: 2 [89600/100000 (90%)]	Loss: 0.113730
Train Epoch: 2 [96000/100000 (96%)]	Loss: 0.336526

Train set: Average loss: 0.4339, Accuracy: 90691/100000 (90.7%)


Test set test: Average loss: 0.9796, Accuracy: 7721/10000 (77.210%)

Test set test_counterfactual: Average loss: 1.0893, Accuracy: 7694/10000 (76.940%)

Test set test_counterfactual_rot: Average loss: 1.3372, Accuracy: 7235/10000 (72.350%)

Test set test_counterfactual_rot_scale: Average loss: 1.5014, Accuracy: 6901/10000 (69.010%)

Test set test_counterfactual_rot_scale_shear: Average loss: 1.8014, Accuracy: 6524/10000 (65.240%)
Train Epoch: 3 [0/100000 (0%)]	Loss: 0.185185
Train Epoch: 3 [6400/100000 (6%)]	Loss: 0.207108
Train Epoch: 3 [12800/100000 (13%)]	Loss: 0.256182
Train Epoch: 3 [19200/100000 (19%)]	Loss: 0.102291
Train Epoch: 3 [25600/100000 (26%)]	Loss: 0.074567
Train Epoch: 3 [32000/100000 (32%)]	Loss: 0.072776
Train Epoch: 3 [38400/100000 (38%)]	Loss: 0.174683
Train Epoch: 3 [44800/100000 (45%)]	Loss: 0.066448
Train Epoch: 3 [51200/100000 (51%)]	Loss: 0.082453
Train Epoch: 3 [57600/100000 (58%)]	Loss: 0.041990
Train Epoch: 3 [64000/100000 (64%)]	Loss: 0.170264
Train Epoch: 3 [70400/100000 (70%)]	Loss: 0.160902
Train Epoch: 3 [76800/100000 (77%)]	Loss: 0.288461
Train Epoch: 3 [83200/100000 (83%)]	Loss: 0.222412
Train Epoch: 3 [89600/100000 (90%)]	Loss: 0.052492
Train Epoch: 3 [96000/100000 (96%)]	Loss: 0.079303

Train set: Average loss: 0.3163, Accuracy: 96309/100000 (96.3%)


Test set test: Average loss: 1.0448, Accuracy: 7883/10000 (78.830%)

Test set test_counterfactual: Average loss: 1.2266, Accuracy: 7720/10000 (77.200%)

Test set test_counterfactual_rot: Average loss: 1.3319, Accuracy: 7499/10000 (74.990%)

Test set test_counterfactual_rot_scale: Average loss: 1.4706, Accuracy: 7111/10000 (71.110%)

Test set test_counterfactual_rot_scale_shear: Average loss: 1.9265, Accuracy: 6651/10000 (66.510%)
Train Epoch: 4 [0/100000 (0%)]	Loss: 0.057550
Train Epoch: 4 [6400/100000 (6%)]	Loss: 0.048294
Train Epoch: 4 [12800/100000 (13%)]	Loss: 0.163980
Train Epoch: 4 [19200/100000 (19%)]	Loss: 0.026466
Train Epoch: 4 [25600/100000 (26%)]	Loss: 0.054452
Train Epoch: 4 [32000/100000 (32%)]	Loss: 0.085369
Train Epoch: 4 [38400/100000 (38%)]	Loss: 0.042796
Train Epoch: 4 [44800/100000 (45%)]	Loss: 0.021538
Train Epoch: 4 [51200/100000 (51%)]	Loss: 0.009401
Train Epoch: 4 [57600/100000 (58%)]	Loss: 0.049594
Train Epoch: 4 [64000/100000 (64%)]	Loss: 0.017981
Train Epoch: 4 [70400/100000 (70%)]	Loss: 0.078469
Train Epoch: 4 [76800/100000 (77%)]	Loss: 0.017648
Train Epoch: 4 [83200/100000 (83%)]	Loss: 0.048985
Train Epoch: 4 [89600/100000 (90%)]	Loss: 0.018233
Train Epoch: 4 [96000/100000 (96%)]	Loss: 0.014755

Train set: Average loss: 0.0979, Accuracy: 98128/100000 (98.1%)


Test set test: Average loss: 1.2551, Accuracy: 7791/10000 (77.910%)

Test set test_counterfactual: Average loss: 1.3995, Accuracy: 7727/10000 (77.270%)

Test set test_counterfactual_rot: Average loss: 1.6199, Accuracy: 7433/10000 (74.330%)

Test set test_counterfactual_rot_scale: Average loss: 1.8097, Accuracy: 7122/10000 (71.220%)

Test set test_counterfactual_rot_scale_shear: Average loss: 2.3391, Accuracy: 6611/10000 (66.110%)
Train Epoch: 5 [0/100000 (0%)]	Loss: 0.055189
Train Epoch: 5 [6400/100000 (6%)]	Loss: 0.040187
Train Epoch: 5 [12800/100000 (13%)]	Loss: 0.020812
Train Epoch: 5 [19200/100000 (19%)]	Loss: 0.044680
Train Epoch: 5 [25600/100000 (26%)]	Loss: 0.055978
Train Epoch: 5 [32000/100000 (32%)]	Loss: 0.037656
Train Epoch: 5 [38400/100000 (38%)]	Loss: 0.006898
Train Epoch: 5 [44800/100000 (45%)]	Loss: 0.007322
Train Epoch: 5 [51200/100000 (51%)]	Loss: 0.004625
Train Epoch: 5 [57600/100000 (58%)]	Loss: 0.016533
Train Epoch: 5 [64000/100000 (64%)]	Loss: 0.079239
Train Epoch: 5 [70400/100000 (70%)]	Loss: 0.033866
Train Epoch: 5 [76800/100000 (77%)]	Loss: 0.017341
Train Epoch: 5 [83200/100000 (83%)]	Loss: 0.159581
Train Epoch: 5 [89600/100000 (90%)]	Loss: 0.006144
Train Epoch: 5 [96000/100000 (96%)]	Loss: 0.062808

Train set: Average loss: 0.0986, Accuracy: 98920/100000 (98.9%)


Test set test: Average loss: 1.3787, Accuracy: 7691/10000 (76.910%)

Test set test_counterfactual: Average loss: 1.5449, Accuracy: 7617/10000 (76.170%)

Test set test_counterfactual_rot: Average loss: 1.7464, Accuracy: 7389/10000 (73.890%)

Test set test_counterfactual_rot_scale: Average loss: 1.9316, Accuracy: 7027/10000 (70.270%)

Test set test_counterfactual_rot_scale_shear: Average loss: 2.5232, Accuracy: 6525/10000 (65.250%)
Train Epoch: 6 [0/100000 (0%)]	Loss: 0.004206
Train Epoch: 6 [6400/100000 (6%)]	Loss: 0.114243
Train Epoch: 6 [12800/100000 (13%)]	Loss: 0.012332
Train Epoch: 6 [19200/100000 (19%)]	Loss: 0.036976
Train Epoch: 6 [25600/100000 (26%)]	Loss: 0.014237
Train Epoch: 6 [32000/100000 (32%)]	Loss: 0.004150
Train Epoch: 6 [38400/100000 (38%)]	Loss: 0.053422
Train Epoch: 6 [44800/100000 (45%)]	Loss: 0.006571
Train Epoch: 6 [51200/100000 (51%)]	Loss: 0.018700
Train Epoch: 6 [57600/100000 (58%)]	Loss: 0.005534
Train Epoch: 6 [64000/100000 (64%)]	Loss: 0.009704
Train Epoch: 6 [70400/100000 (70%)]	Loss: 0.044300
Train Epoch: 6 [76800/100000 (77%)]	Loss: 0.044318
Train Epoch: 6 [83200/100000 (83%)]	Loss: 0.038958
Train Epoch: 6 [89600/100000 (90%)]	Loss: 0.013545
Train Epoch: 6 [96000/100000 (96%)]	Loss: 0.010632

Train set: Average loss: 0.0075, Accuracy: 99314/100000 (99.3%)


Test set test: Average loss: 1.3683, Accuracy: 7755/10000 (77.550%)

Test set test_counterfactual: Average loss: 1.5173, Accuracy: 7703/10000 (77.030%)

Test set test_counterfactual_rot: Average loss: 1.6806, Accuracy: 7469/10000 (74.690%)

Test set test_counterfactual_rot_scale: Average loss: 1.8311, Accuracy: 7213/10000 (72.130%)

Test set test_counterfactual_rot_scale_shear: Average loss: 2.3829, Accuracy: 6695/10000 (66.950%)
Train Epoch: 7 [0/100000 (0%)]	Loss: 0.002663
Train Epoch: 7 [6400/100000 (6%)]	Loss: 0.009343
Train Epoch: 7 [12800/100000 (13%)]	Loss: 0.006070
Train Epoch: 7 [19200/100000 (19%)]	Loss: 0.025402
Train Epoch: 7 [25600/100000 (26%)]	Loss: 0.011865
Train Epoch: 7 [32000/100000 (32%)]	Loss: 0.013071
Train Epoch: 7 [38400/100000 (38%)]	Loss: 0.003148
Train Epoch: 7 [44800/100000 (45%)]	Loss: 0.002866
Train Epoch: 7 [51200/100000 (51%)]	Loss: 0.029247
Train Epoch: 7 [57600/100000 (58%)]	Loss: 0.002110
Train Epoch: 7 [64000/100000 (64%)]	Loss: 0.022810
Train Epoch: 7 [70400/100000 (70%)]	Loss: 0.002174
Train Epoch: 7 [76800/100000 (77%)]	Loss: 0.027358
Train Epoch: 7 [83200/100000 (83%)]	Loss: 0.017038
Train Epoch: 7 [89600/100000 (90%)]	Loss: 0.013791
Train Epoch: 7 [96000/100000 (96%)]	Loss: 0.001999

Train set: Average loss: 0.0017, Accuracy: 99499/100000 (99.5%)


Test set test: Average loss: 1.3771, Accuracy: 7808/10000 (78.080%)

Test set test_counterfactual: Average loss: 1.5609, Accuracy: 7782/10000 (77.820%)

Test set test_counterfactual_rot: Average loss: 1.7707, Accuracy: 7447/10000 (74.470%)

Test set test_counterfactual_rot_scale: Average loss: 1.9420, Accuracy: 7138/10000 (71.380%)

Test set test_counterfactual_rot_scale_shear: Average loss: 2.4928, Accuracy: 6630/10000 (66.300%)
Train Epoch: 8 [0/100000 (0%)]	Loss: 0.005063
Train Epoch: 8 [6400/100000 (6%)]	Loss: 0.011112
Train Epoch: 8 [12800/100000 (13%)]	Loss: 0.000592
Train Epoch: 8 [19200/100000 (19%)]	Loss: 0.015086
Train Epoch: 8 [25600/100000 (26%)]	Loss: 0.004433
Train Epoch: 8 [32000/100000 (32%)]	Loss: 0.005896
Train Epoch: 8 [38400/100000 (38%)]	Loss: 0.004982
Train Epoch: 8 [44800/100000 (45%)]	Loss: 0.007481
Train Epoch: 8 [51200/100000 (51%)]	Loss: 0.000678
Train Epoch: 8 [57600/100000 (58%)]	Loss: 0.013670
Train Epoch: 8 [64000/100000 (64%)]	Loss: 0.012955
Train Epoch: 8 [70400/100000 (70%)]	Loss: 0.011383
Train Epoch: 8 [76800/100000 (77%)]	Loss: 0.039392
Train Epoch: 8 [83200/100000 (83%)]	Loss: 0.003460
Train Epoch: 8 [89600/100000 (90%)]	Loss: 0.013601
Train Epoch: 8 [96000/100000 (96%)]	Loss: 0.019158

Train set: Average loss: 0.0021, Accuracy: 99606/100000 (99.6%)


Test set test: Average loss: 1.4538, Accuracy: 7701/10000 (77.010%)

Test set test_counterfactual: Average loss: 1.6281, Accuracy: 7682/10000 (76.820%)

Test set test_counterfactual_rot: Average loss: 1.8148, Accuracy: 7409/10000 (74.090%)

Test set test_counterfactual_rot_scale: Average loss: 1.9819, Accuracy: 7132/10000 (71.320%)

Test set test_counterfactual_rot_scale_shear: Average loss: 2.5491, Accuracy: 6625/10000 (66.250%)
Train Epoch: 9 [0/100000 (0%)]	Loss: 0.007628
Train Epoch: 9 [6400/100000 (6%)]	Loss: 0.015572
Train Epoch: 9 [12800/100000 (13%)]	Loss: 0.005432
Train Epoch: 9 [19200/100000 (19%)]	Loss: 0.011497
Train Epoch: 9 [25600/100000 (26%)]	Loss: 0.006411
Train Epoch: 9 [32000/100000 (32%)]	Loss: 0.003361
Train Epoch: 9 [38400/100000 (38%)]	Loss: 0.001072
Train Epoch: 9 [44800/100000 (45%)]	Loss: 0.005325
Train Epoch: 9 [51200/100000 (51%)]	Loss: 0.004940
Train Epoch: 9 [57600/100000 (58%)]	Loss: 0.002127
Train Epoch: 9 [64000/100000 (64%)]	Loss: 0.033320
Train Epoch: 9 [70400/100000 (70%)]	Loss: 0.013026
Train Epoch: 9 [76800/100000 (77%)]	Loss: 0.006844
Train Epoch: 9 [83200/100000 (83%)]	Loss: 0.007627
Train Epoch: 9 [89600/100000 (90%)]	Loss: 0.002125
Train Epoch: 9 [96000/100000 (96%)]	Loss: 0.002876

Train set: Average loss: 0.0010, Accuracy: 99632/100000 (99.6%)


Test set test: Average loss: 1.4407, Accuracy: 7760/10000 (77.600%)

Test set test_counterfactual: Average loss: 1.6233, Accuracy: 7700/10000 (77.000%)

Test set test_counterfactual_rot: Average loss: 1.8589, Accuracy: 7403/10000 (74.030%)

Test set test_counterfactual_rot_scale: Average loss: 2.0419, Accuracy: 7125/10000 (71.250%)

Test set test_counterfactual_rot_scale_shear: Average loss: 2.6038, Accuracy: 6621/10000 (66.210%)
Train Epoch: 10 [0/100000 (0%)]	Loss: 0.009571
Train Epoch: 10 [6400/100000 (6%)]	Loss: 0.002375
Train Epoch: 10 [12800/100000 (13%)]	Loss: 0.015903
Train Epoch: 10 [19200/100000 (19%)]	Loss: 0.001023
Train Epoch: 10 [25600/100000 (26%)]	Loss: 0.001102
Train Epoch: 10 [32000/100000 (32%)]	Loss: 0.009988
Train Epoch: 10 [38400/100000 (38%)]	Loss: 0.006571
Train Epoch: 10 [44800/100000 (45%)]	Loss: 0.004142
Train Epoch: 10 [51200/100000 (51%)]	Loss: 0.006123
Train Epoch: 10 [57600/100000 (58%)]	Loss: 0.004147
Train Epoch: 10 [64000/100000 (64%)]	Loss: 0.001467
Train Epoch: 10 [70400/100000 (70%)]	Loss: 0.007277
Train Epoch: 10 [76800/100000 (77%)]	Loss: 0.003444
Train Epoch: 10 [83200/100000 (83%)]	Loss: 0.008118
Train Epoch: 10 [89600/100000 (90%)]	Loss: 0.001486
Train Epoch: 10 [96000/100000 (96%)]	Loss: 0.008284

Train set: Average loss: 0.1172, Accuracy: 99700/100000 (99.7%)


Test set test: Average loss: 1.4549, Accuracy: 7751/10000 (77.510%)

Test set test_counterfactual: Average loss: 1.6457, Accuracy: 7678/10000 (76.780%)

Test set test_counterfactual_rot: Average loss: 1.9021, Accuracy: 7336/10000 (73.360%)

Test set test_counterfactual_rot_scale: Average loss: 2.0779, Accuracy: 7047/10000 (70.470%)

Test set test_counterfactual_rot_scale_shear: Average loss: 2.7096, Accuracy: 6551/10000 (65.510%)
