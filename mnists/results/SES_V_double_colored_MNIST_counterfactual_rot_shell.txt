Namespace(dataset='double_colored_MNIST_counterfactual_rot', batch_size=64, epochs=10, lr=1.0, gamma=0.7, log_interval=100, model='SES_V')

Number of trainable parameters: 619285

Train Epoch: 1 [0/100000 (0%)]	Loss: 2.511726
Train Epoch: 1 [6400/100000 (6%)]	Loss: 1.771222
Train Epoch: 1 [12800/100000 (13%)]	Loss: 1.408013
Train Epoch: 1 [19200/100000 (19%)]	Loss: 1.313253
Train Epoch: 1 [25600/100000 (26%)]	Loss: 1.419950
Train Epoch: 1 [32000/100000 (32%)]	Loss: 1.242275
Train Epoch: 1 [38400/100000 (38%)]	Loss: 1.023581
Train Epoch: 1 [44800/100000 (45%)]	Loss: 1.154250
Train Epoch: 1 [51200/100000 (51%)]	Loss: 0.931367
Train Epoch: 1 [57600/100000 (58%)]	Loss: 0.901915
Train Epoch: 1 [64000/100000 (64%)]	Loss: 1.071728
Train Epoch: 1 [70400/100000 (70%)]	Loss: 1.052605
Train Epoch: 1 [76800/100000 (77%)]	Loss: 0.809880
Train Epoch: 1 [83200/100000 (83%)]	Loss: 0.946364
Train Epoch: 1 [89600/100000 (90%)]	Loss: 0.951848
Train Epoch: 1 [96000/100000 (96%)]	Loss: 0.696509

Train set: Average loss: 0.5269, Accuracy: 59116/100000 (59.1%)


Test set test: Average loss: 0.8863, Accuracy: 7567/10000 (75.670%)

Test set test_counterfactual: Average loss: 0.9005, Accuracy: 7544/10000 (75.440%)

Test set test_counterfactual_rot: Average loss: 6.1685, Accuracy: 3437/10000 (34.370%)

Test set test_counterfactual_rot_scale: Average loss: 5.5037, Accuracy: 3384/10000 (33.840%)

Test set test_counterfactual_rot_scale_shear: Average loss: 5.5556, Accuracy: 3067/10000 (30.670%)
Train Epoch: 2 [0/100000 (0%)]	Loss: 0.911394
Train Epoch: 2 [6400/100000 (6%)]	Loss: 0.525348
Train Epoch: 2 [12800/100000 (13%)]	Loss: 0.676375
Train Epoch: 2 [19200/100000 (19%)]	Loss: 0.702652
Train Epoch: 2 [25600/100000 (26%)]	Loss: 0.432216
Train Epoch: 2 [32000/100000 (32%)]	Loss: 0.726383
Train Epoch: 2 [38400/100000 (38%)]	Loss: 0.521687
Train Epoch: 2 [44800/100000 (45%)]	Loss: 0.532945
Train Epoch: 2 [51200/100000 (51%)]	Loss: 0.501581
Train Epoch: 2 [57600/100000 (58%)]	Loss: 0.512547
Train Epoch: 2 [64000/100000 (64%)]	Loss: 0.647044
Train Epoch: 2 [70400/100000 (70%)]	Loss: 0.687504
Train Epoch: 2 [76800/100000 (77%)]	Loss: 0.366360
Train Epoch: 2 [83200/100000 (83%)]	Loss: 0.460679
Train Epoch: 2 [89600/100000 (90%)]	Loss: 0.402539
Train Epoch: 2 [96000/100000 (96%)]	Loss: 0.501673

Train set: Average loss: 0.5468, Accuracy: 79491/100000 (79.5%)


Test set test: Average loss: 0.9491, Accuracy: 7942/10000 (79.420%)

Test set test_counterfactual: Average loss: 0.9660, Accuracy: 7953/10000 (79.530%)

Test set test_counterfactual_rot: Average loss: 8.7322, Accuracy: 3881/10000 (38.810%)

Test set test_counterfactual_rot_scale: Average loss: 7.2057, Accuracy: 3687/10000 (36.870%)

Test set test_counterfactual_rot_scale_shear: Average loss: 7.2279, Accuracy: 3337/10000 (33.370%)
Train Epoch: 3 [0/100000 (0%)]	Loss: 0.453268
Train Epoch: 3 [6400/100000 (6%)]	Loss: 0.439122
Train Epoch: 3 [12800/100000 (13%)]	Loss: 0.347904
Train Epoch: 3 [19200/100000 (19%)]	Loss: 0.579953
Train Epoch: 3 [25600/100000 (26%)]	Loss: 0.512566
Train Epoch: 3 [32000/100000 (32%)]	Loss: 0.316239
Train Epoch: 3 [38400/100000 (38%)]	Loss: 0.350938
Train Epoch: 3 [44800/100000 (45%)]	Loss: 0.332321
Train Epoch: 3 [51200/100000 (51%)]	Loss: 0.364661
Train Epoch: 3 [57600/100000 (58%)]	Loss: 0.409202
Train Epoch: 3 [64000/100000 (64%)]	Loss: 0.458525
Train Epoch: 3 [70400/100000 (70%)]	Loss: 0.275246
Train Epoch: 3 [76800/100000 (77%)]	Loss: 0.281522
Train Epoch: 3 [83200/100000 (83%)]	Loss: 0.625412
Train Epoch: 3 [89600/100000 (90%)]	Loss: 0.232191
Train Epoch: 3 [96000/100000 (96%)]	Loss: 0.309520

Train set: Average loss: 0.4188, Accuracy: 85285/100000 (85.3%)


Test set test: Average loss: 1.3648, Accuracy: 7888/10000 (78.880%)

Test set test_counterfactual: Average loss: 1.3910, Accuracy: 7886/10000 (78.860%)

Test set test_counterfactual_rot: Average loss: 11.1299, Accuracy: 3885/10000 (38.850%)

Test set test_counterfactual_rot_scale: Average loss: 9.1735, Accuracy: 3730/10000 (37.300%)

Test set test_counterfactual_rot_scale_shear: Average loss: 9.1946, Accuracy: 3393/10000 (33.930%)
Train Epoch: 4 [0/100000 (0%)]	Loss: 0.172403
Train Epoch: 4 [6400/100000 (6%)]	Loss: 0.296969
Train Epoch: 4 [12800/100000 (13%)]	Loss: 0.267369
Train Epoch: 4 [19200/100000 (19%)]	Loss: 0.214058
Train Epoch: 4 [25600/100000 (26%)]	Loss: 0.431074
Train Epoch: 4 [32000/100000 (32%)]	Loss: 0.411737
Train Epoch: 4 [38400/100000 (38%)]	Loss: 0.330532
Train Epoch: 4 [44800/100000 (45%)]	Loss: 0.602230
Train Epoch: 4 [51200/100000 (51%)]	Loss: 0.263732
Train Epoch: 4 [57600/100000 (58%)]	Loss: 0.390762
Train Epoch: 4 [64000/100000 (64%)]	Loss: 0.242988
Train Epoch: 4 [70400/100000 (70%)]	Loss: 0.305367
Train Epoch: 4 [76800/100000 (77%)]	Loss: 0.254735
Train Epoch: 4 [83200/100000 (83%)]	Loss: 0.255586
Train Epoch: 4 [89600/100000 (90%)]	Loss: 0.372555
Train Epoch: 4 [96000/100000 (96%)]	Loss: 0.436213

Train set: Average loss: 0.5512, Accuracy: 88389/100000 (88.4%)


Test set test: Average loss: 1.5497, Accuracy: 7871/10000 (78.710%)

Test set test_counterfactual: Average loss: 1.5895, Accuracy: 7825/10000 (78.250%)

Test set test_counterfactual_rot: Average loss: 12.5093, Accuracy: 3918/10000 (39.180%)

Test set test_counterfactual_rot_scale: Average loss: 10.3526, Accuracy: 3759/10000 (37.590%)

Test set test_counterfactual_rot_scale_shear: Average loss: 10.4154, Accuracy: 3394/10000 (33.940%)
Train Epoch: 5 [0/100000 (0%)]	Loss: 0.268412
Train Epoch: 5 [6400/100000 (6%)]	Loss: 0.468311
Train Epoch: 5 [12800/100000 (13%)]	Loss: 0.184175
Train Epoch: 5 [19200/100000 (19%)]	Loss: 0.334277
Train Epoch: 5 [25600/100000 (26%)]	Loss: 0.244745
Train Epoch: 5 [32000/100000 (32%)]	Loss: 0.411193
Train Epoch: 5 [38400/100000 (38%)]	Loss: 0.295237
Train Epoch: 5 [44800/100000 (45%)]	Loss: 0.131474
Train Epoch: 5 [51200/100000 (51%)]	Loss: 0.265129
Train Epoch: 5 [57600/100000 (58%)]	Loss: 0.274136
Train Epoch: 5 [64000/100000 (64%)]	Loss: 0.174773
Train Epoch: 5 [70400/100000 (70%)]	Loss: 0.215484
Train Epoch: 5 [76800/100000 (77%)]	Loss: 0.320863
Train Epoch: 5 [83200/100000 (83%)]	Loss: 0.475482
Train Epoch: 5 [89600/100000 (90%)]	Loss: 0.243183
Train Epoch: 5 [96000/100000 (96%)]	Loss: 0.338858

Train set: Average loss: 0.3007, Accuracy: 89906/100000 (89.9%)


Test set test: Average loss: 1.4787, Accuracy: 7992/10000 (79.920%)

Test set test_counterfactual: Average loss: 1.5178, Accuracy: 7985/10000 (79.850%)

Test set test_counterfactual_rot: Average loss: 13.6374, Accuracy: 3884/10000 (38.840%)

Test set test_counterfactual_rot_scale: Average loss: 11.0793, Accuracy: 3753/10000 (37.530%)

Test set test_counterfactual_rot_scale_shear: Average loss: 11.2150, Accuracy: 3405/10000 (34.050%)
Train Epoch: 6 [0/100000 (0%)]	Loss: 0.324912
Train Epoch: 6 [6400/100000 (6%)]	Loss: 0.197949
Train Epoch: 6 [12800/100000 (13%)]	Loss: 0.255014
Train Epoch: 6 [19200/100000 (19%)]	Loss: 0.247198
Train Epoch: 6 [25600/100000 (26%)]	Loss: 0.343010
Train Epoch: 6 [32000/100000 (32%)]	Loss: 0.393339
Train Epoch: 6 [38400/100000 (38%)]	Loss: 0.320423
Train Epoch: 6 [44800/100000 (45%)]	Loss: 0.194311
Train Epoch: 6 [51200/100000 (51%)]	Loss: 0.296344
Train Epoch: 6 [57600/100000 (58%)]	Loss: 0.242610
Train Epoch: 6 [64000/100000 (64%)]	Loss: 0.264233
Train Epoch: 6 [70400/100000 (70%)]	Loss: 0.215615
Train Epoch: 6 [76800/100000 (77%)]	Loss: 0.283006
Train Epoch: 6 [83200/100000 (83%)]	Loss: 0.340862
Train Epoch: 6 [89600/100000 (90%)]	Loss: 0.489406
Train Epoch: 6 [96000/100000 (96%)]	Loss: 0.229738

Train set: Average loss: 0.2109, Accuracy: 91145/100000 (91.1%)


Test set test: Average loss: 1.4959, Accuracy: 8008/10000 (80.080%)

Test set test_counterfactual: Average loss: 1.5182, Accuracy: 7971/10000 (79.710%)

Test set test_counterfactual_rot: Average loss: 13.3236, Accuracy: 4009/10000 (40.090%)

Test set test_counterfactual_rot_scale: Average loss: 11.1490, Accuracy: 3822/10000 (38.220%)

Test set test_counterfactual_rot_scale_shear: Average loss: 11.2871, Accuracy: 3455/10000 (34.550%)
Train Epoch: 7 [0/100000 (0%)]	Loss: 0.224803
Train Epoch: 7 [6400/100000 (6%)]	Loss: 0.196506
Train Epoch: 7 [12800/100000 (13%)]	Loss: 0.243018
Train Epoch: 7 [19200/100000 (19%)]	Loss: 0.215981
Train Epoch: 7 [25600/100000 (26%)]	Loss: 0.147496
Train Epoch: 7 [32000/100000 (32%)]	Loss: 0.132252
Train Epoch: 7 [38400/100000 (38%)]	Loss: 0.137002
Train Epoch: 7 [44800/100000 (45%)]	Loss: 0.083702
Train Epoch: 7 [51200/100000 (51%)]	Loss: 0.243283
Train Epoch: 7 [57600/100000 (58%)]	Loss: 0.459741
Train Epoch: 7 [64000/100000 (64%)]	Loss: 0.099275
Train Epoch: 7 [70400/100000 (70%)]	Loss: 0.252284
Train Epoch: 7 [76800/100000 (77%)]	Loss: 0.278241
Train Epoch: 7 [83200/100000 (83%)]	Loss: 0.259204
Train Epoch: 7 [89600/100000 (90%)]	Loss: 0.193845
Train Epoch: 7 [96000/100000 (96%)]	Loss: 0.247594

Train set: Average loss: 0.2524, Accuracy: 91665/100000 (91.7%)


Test set test: Average loss: 1.5182, Accuracy: 8075/10000 (80.750%)

Test set test_counterfactual: Average loss: 1.5374, Accuracy: 8051/10000 (80.510%)

Test set test_counterfactual_rot: Average loss: 13.5202, Accuracy: 4029/10000 (40.290%)

Test set test_counterfactual_rot_scale: Average loss: 11.1807, Accuracy: 3850/10000 (38.500%)

Test set test_counterfactual_rot_scale_shear: Average loss: 11.3398, Accuracy: 3510/10000 (35.100%)
Train Epoch: 8 [0/100000 (0%)]	Loss: 0.345301
Train Epoch: 8 [6400/100000 (6%)]	Loss: 0.145574
Train Epoch: 8 [12800/100000 (13%)]	Loss: 0.164961
Train Epoch: 8 [19200/100000 (19%)]	Loss: 0.128768
Train Epoch: 8 [25600/100000 (26%)]	Loss: 0.177143
Train Epoch: 8 [32000/100000 (32%)]	Loss: 0.156038
Train Epoch: 8 [38400/100000 (38%)]	Loss: 0.085472
Train Epoch: 8 [44800/100000 (45%)]	Loss: 0.282197
Train Epoch: 8 [51200/100000 (51%)]	Loss: 0.330450
Train Epoch: 8 [57600/100000 (58%)]	Loss: 0.176806
Train Epoch: 8 [64000/100000 (64%)]	Loss: 0.139578
Train Epoch: 8 [70400/100000 (70%)]	Loss: 0.100333
Train Epoch: 8 [76800/100000 (77%)]	Loss: 0.349753
Train Epoch: 8 [83200/100000 (83%)]	Loss: 0.260964
Train Epoch: 8 [89600/100000 (90%)]	Loss: 0.234987
Train Epoch: 8 [96000/100000 (96%)]	Loss: 0.189345

Train set: Average loss: 0.3493, Accuracy: 92112/100000 (92.1%)


Test set test: Average loss: 1.7686, Accuracy: 8023/10000 (80.230%)

Test set test_counterfactual: Average loss: 1.7854, Accuracy: 7998/10000 (79.980%)

Test set test_counterfactual_rot: Average loss: 15.0760, Accuracy: 3978/10000 (39.780%)

Test set test_counterfactual_rot_scale: Average loss: 12.7180, Accuracy: 3779/10000 (37.790%)

Test set test_counterfactual_rot_scale_shear: Average loss: 12.8902, Accuracy: 3431/10000 (34.310%)
Train Epoch: 9 [0/100000 (0%)]	Loss: 0.184713
Train Epoch: 9 [6400/100000 (6%)]	Loss: 0.217593
Train Epoch: 9 [12800/100000 (13%)]	Loss: 0.207326
Train Epoch: 9 [19200/100000 (19%)]	Loss: 0.087748
Train Epoch: 9 [25600/100000 (26%)]	Loss: 0.437429
Train Epoch: 9 [32000/100000 (32%)]	Loss: 0.209179
Train Epoch: 9 [38400/100000 (38%)]	Loss: 0.210132
Train Epoch: 9 [44800/100000 (45%)]	Loss: 0.215166
Train Epoch: 9 [51200/100000 (51%)]	Loss: 0.288411
Train Epoch: 9 [57600/100000 (58%)]	Loss: 0.192047
Train Epoch: 9 [64000/100000 (64%)]	Loss: 0.310808
Train Epoch: 9 [70400/100000 (70%)]	Loss: 0.230140
Train Epoch: 9 [76800/100000 (77%)]	Loss: 0.137845
Train Epoch: 9 [83200/100000 (83%)]	Loss: 0.090096
Train Epoch: 9 [89600/100000 (90%)]	Loss: 0.209359
Train Epoch: 9 [96000/100000 (96%)]	Loss: 0.238877

Train set: Average loss: 0.1789, Accuracy: 92467/100000 (92.5%)


Test set test: Average loss: 1.6112, Accuracy: 8084/10000 (80.840%)

Test set test_counterfactual: Average loss: 1.6200, Accuracy: 8095/10000 (80.950%)

Test set test_counterfactual_rot: Average loss: 14.5342, Accuracy: 4020/10000 (40.200%)

Test set test_counterfactual_rot_scale: Average loss: 12.2067, Accuracy: 3844/10000 (38.440%)

Test set test_counterfactual_rot_scale_shear: Average loss: 12.3865, Accuracy: 3487/10000 (34.870%)
Train Epoch: 10 [0/100000 (0%)]	Loss: 0.251064
Train Epoch: 10 [6400/100000 (6%)]	Loss: 0.204217
Train Epoch: 10 [12800/100000 (13%)]	Loss: 0.251211
Train Epoch: 10 [19200/100000 (19%)]	Loss: 0.262928
Train Epoch: 10 [25600/100000 (26%)]	Loss: 0.257608
Train Epoch: 10 [32000/100000 (32%)]	Loss: 0.256337
Train Epoch: 10 [38400/100000 (38%)]	Loss: 0.209202
Train Epoch: 10 [44800/100000 (45%)]	Loss: 0.207241
Train Epoch: 10 [51200/100000 (51%)]	Loss: 0.124196
Train Epoch: 10 [57600/100000 (58%)]	Loss: 0.262815
Train Epoch: 10 [64000/100000 (64%)]	Loss: 0.204051
Train Epoch: 10 [70400/100000 (70%)]	Loss: 0.253097
Train Epoch: 10 [76800/100000 (77%)]	Loss: 0.209858
Train Epoch: 10 [83200/100000 (83%)]	Loss: 0.298153
Train Epoch: 10 [89600/100000 (90%)]	Loss: 0.139195
Train Epoch: 10 [96000/100000 (96%)]	Loss: 0.225932

Train set: Average loss: 0.8857, Accuracy: 92677/100000 (92.7%)


Test set test: Average loss: 1.7015, Accuracy: 8107/10000 (81.070%)

Test set test_counterfactual: Average loss: 1.7163, Accuracy: 8104/10000 (81.040%)

Test set test_counterfactual_rot: Average loss: 14.9654, Accuracy: 3990/10000 (39.900%)

Test set test_counterfactual_rot_scale: Average loss: 12.5976, Accuracy: 3843/10000 (38.430%)

Test set test_counterfactual_rot_scale_shear: Average loss: 12.7937, Accuracy: 3486/10000 (34.860%)
