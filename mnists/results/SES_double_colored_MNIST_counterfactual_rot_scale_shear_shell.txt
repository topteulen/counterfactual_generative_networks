Namespace(dataset='double_colored_MNIST_counterfactual_rot_scale_shear', batch_size=64, epochs=10, lr=1.0, gamma=0.7, log_interval=100, model='SES')

Number of trainable parameters: 619285

Train Epoch: 1 [0/100000 (0%)]	Loss: 2.652124
Train Epoch: 1 [6400/100000 (6%)]	Loss: 2.172261
Train Epoch: 1 [12800/100000 (13%)]	Loss: 2.100595
Train Epoch: 1 [19200/100000 (19%)]	Loss: 1.855311
Train Epoch: 1 [25600/100000 (26%)]	Loss: 1.621868
Train Epoch: 1 [32000/100000 (32%)]	Loss: 1.972660
Train Epoch: 1 [38400/100000 (38%)]	Loss: 1.322461
Train Epoch: 1 [44800/100000 (45%)]	Loss: 1.447187
Train Epoch: 1 [51200/100000 (51%)]	Loss: 1.102713
Train Epoch: 1 [57600/100000 (58%)]	Loss: 1.618890
Train Epoch: 1 [64000/100000 (64%)]	Loss: 1.508719
Train Epoch: 1 [70400/100000 (70%)]	Loss: 1.197310
Train Epoch: 1 [76800/100000 (77%)]	Loss: 0.957883
Train Epoch: 1 [83200/100000 (83%)]	Loss: 1.247491
Train Epoch: 1 [89600/100000 (90%)]	Loss: 1.087023
Train Epoch: 1 [96000/100000 (96%)]	Loss: 0.996179

Train set: Average loss: 1.3422, Accuracy: 43698/100000 (43.7%)


Test set test: Average loss: 1.0061, Accuracy: 7122/10000 (71.220%)

Test set test_counterfactual: Average loss: 1.0069, Accuracy: 7101/10000 (71.010%)

Test set test_counterfactual_rot: Average loss: 4.4708, Accuracy: 3304/10000 (33.040%)

Test set test_counterfactual_rot_scale: Average loss: 3.8291, Accuracy: 3475/10000 (34.750%)

Test set test_counterfactual_rot_scale_shear: Average loss: 3.8708, Accuracy: 3332/10000 (33.320%)
Train Epoch: 2 [0/100000 (0%)]	Loss: 1.115815
Train Epoch: 2 [6400/100000 (6%)]	Loss: 1.323358
Train Epoch: 2 [12800/100000 (13%)]	Loss: 0.942107
Train Epoch: 2 [19200/100000 (19%)]	Loss: 0.936582
Train Epoch: 2 [25600/100000 (26%)]	Loss: 1.141318
Train Epoch: 2 [32000/100000 (32%)]	Loss: 1.230573
Train Epoch: 2 [38400/100000 (38%)]	Loss: 1.057053
Train Epoch: 2 [44800/100000 (45%)]	Loss: 1.034720
Train Epoch: 2 [51200/100000 (51%)]	Loss: 0.881419
Train Epoch: 2 [57600/100000 (58%)]	Loss: 1.165089
Train Epoch: 2 [64000/100000 (64%)]	Loss: 0.965312
Train Epoch: 2 [70400/100000 (70%)]	Loss: 1.118695
Train Epoch: 2 [76800/100000 (77%)]	Loss: 1.139152
Train Epoch: 2 [83200/100000 (83%)]	Loss: 1.168093
Train Epoch: 2 [89600/100000 (90%)]	Loss: 0.894302
Train Epoch: 2 [96000/100000 (96%)]	Loss: 0.690015

Train set: Average loss: 1.3362, Accuracy: 65681/100000 (65.7%)


Test set test: Average loss: 0.9681, Accuracy: 7531/10000 (75.310%)

Test set test_counterfactual: Average loss: 0.9780, Accuracy: 7561/10000 (75.610%)

Test set test_counterfactual_rot: Average loss: 6.2830, Accuracy: 3671/10000 (36.710%)

Test set test_counterfactual_rot_scale: Average loss: 4.4555, Accuracy: 4020/10000 (40.200%)

Test set test_counterfactual_rot_scale_shear: Average loss: 4.4339, Accuracy: 3870/10000 (38.700%)
Train Epoch: 3 [0/100000 (0%)]	Loss: 0.771435
Train Epoch: 3 [6400/100000 (6%)]	Loss: 0.776584
Train Epoch: 3 [12800/100000 (13%)]	Loss: 0.781458
Train Epoch: 3 [19200/100000 (19%)]	Loss: 0.623123
Train Epoch: 3 [25600/100000 (26%)]	Loss: 1.101035
Train Epoch: 3 [32000/100000 (32%)]	Loss: 0.724049
Train Epoch: 3 [38400/100000 (38%)]	Loss: 0.805217
Train Epoch: 3 [44800/100000 (45%)]	Loss: 0.590537
Train Epoch: 3 [51200/100000 (51%)]	Loss: 0.663074
Train Epoch: 3 [57600/100000 (58%)]	Loss: 0.980895
Train Epoch: 3 [64000/100000 (64%)]	Loss: 0.668033
Train Epoch: 3 [70400/100000 (70%)]	Loss: 0.745947
Train Epoch: 3 [76800/100000 (77%)]	Loss: 0.622446
Train Epoch: 3 [83200/100000 (83%)]	Loss: 0.512411
Train Epoch: 3 [89600/100000 (90%)]	Loss: 0.798877
Train Epoch: 3 [96000/100000 (96%)]	Loss: 0.698914

Train set: Average loss: 0.7645, Accuracy: 74338/100000 (74.3%)


Test set test: Average loss: 1.0244, Accuracy: 7948/10000 (79.480%)

Test set test_counterfactual: Average loss: 1.0391, Accuracy: 7971/10000 (79.710%)

Test set test_counterfactual_rot: Average loss: 8.9709, Accuracy: 3784/10000 (37.840%)

Test set test_counterfactual_rot_scale: Average loss: 6.2580, Accuracy: 4134/10000 (41.340%)

Test set test_counterfactual_rot_scale_shear: Average loss: 6.2343, Accuracy: 3885/10000 (38.850%)
Train Epoch: 4 [0/100000 (0%)]	Loss: 0.461397
Train Epoch: 4 [6400/100000 (6%)]	Loss: 0.878601
Train Epoch: 4 [12800/100000 (13%)]	Loss: 0.637484
Train Epoch: 4 [19200/100000 (19%)]	Loss: 0.616396
Train Epoch: 4 [25600/100000 (26%)]	Loss: 0.771062
Train Epoch: 4 [32000/100000 (32%)]	Loss: 0.576340
Train Epoch: 4 [38400/100000 (38%)]	Loss: 0.527354
Train Epoch: 4 [44800/100000 (45%)]	Loss: 0.544030
Train Epoch: 4 [51200/100000 (51%)]	Loss: 0.880827
Train Epoch: 4 [57600/100000 (58%)]	Loss: 0.705556
Train Epoch: 4 [64000/100000 (64%)]	Loss: 0.584444
Train Epoch: 4 [70400/100000 (70%)]	Loss: 0.532516
Train Epoch: 4 [76800/100000 (77%)]	Loss: 0.657196
Train Epoch: 4 [83200/100000 (83%)]	Loss: 0.697334
Train Epoch: 4 [89600/100000 (90%)]	Loss: 0.589811
Train Epoch: 4 [96000/100000 (96%)]	Loss: 0.444464

Train set: Average loss: 0.4308, Accuracy: 79432/100000 (79.4%)


Test set test: Average loss: 1.4141, Accuracy: 7808/10000 (78.080%)

Test set test_counterfactual: Average loss: 1.4408, Accuracy: 7841/10000 (78.410%)

Test set test_counterfactual_rot: Average loss: 10.0508, Accuracy: 3818/10000 (38.180%)

Test set test_counterfactual_rot_scale: Average loss: 7.1828, Accuracy: 4194/10000 (41.940%)

Test set test_counterfactual_rot_scale_shear: Average loss: 7.1118, Accuracy: 3959/10000 (39.590%)
Train Epoch: 5 [0/100000 (0%)]	Loss: 0.517777
Train Epoch: 5 [6400/100000 (6%)]	Loss: 0.391715
Train Epoch: 5 [12800/100000 (13%)]	Loss: 0.318597
Train Epoch: 5 [19200/100000 (19%)]	Loss: 0.642169
Train Epoch: 5 [25600/100000 (26%)]	Loss: 0.482936
Train Epoch: 5 [32000/100000 (32%)]	Loss: 0.406572
Train Epoch: 5 [38400/100000 (38%)]	Loss: 0.508158
Train Epoch: 5 [44800/100000 (45%)]	Loss: 0.591158
Train Epoch: 5 [51200/100000 (51%)]	Loss: 0.390328
Train Epoch: 5 [57600/100000 (58%)]	Loss: 0.340783
Train Epoch: 5 [64000/100000 (64%)]	Loss: 0.393984
Train Epoch: 5 [70400/100000 (70%)]	Loss: 0.311589
Train Epoch: 5 [76800/100000 (77%)]	Loss: 0.518573
Train Epoch: 5 [83200/100000 (83%)]	Loss: 0.535567
Train Epoch: 5 [89600/100000 (90%)]	Loss: 0.660414
Train Epoch: 5 [96000/100000 (96%)]	Loss: 0.369617

Train set: Average loss: 0.3641, Accuracy: 82708/100000 (82.7%)


Test set test: Average loss: 1.3145, Accuracy: 7989/10000 (79.890%)

Test set test_counterfactual: Average loss: 1.3330, Accuracy: 7958/10000 (79.580%)

Test set test_counterfactual_rot: Average loss: 11.3226, Accuracy: 3817/10000 (38.170%)

Test set test_counterfactual_rot_scale: Average loss: 7.6635, Accuracy: 4226/10000 (42.260%)

Test set test_counterfactual_rot_scale_shear: Average loss: 7.5653, Accuracy: 3980/10000 (39.800%)
Train Epoch: 6 [0/100000 (0%)]	Loss: 0.568083
Train Epoch: 6 [6400/100000 (6%)]	Loss: 0.368597
Train Epoch: 6 [12800/100000 (13%)]	Loss: 0.389982
Train Epoch: 6 [19200/100000 (19%)]	Loss: 0.249133
Train Epoch: 6 [25600/100000 (26%)]	Loss: 0.444337
Train Epoch: 6 [32000/100000 (32%)]	Loss: 0.355418
Train Epoch: 6 [38400/100000 (38%)]	Loss: 0.585507
Train Epoch: 6 [44800/100000 (45%)]	Loss: 0.443113
Train Epoch: 6 [51200/100000 (51%)]	Loss: 0.513530
Train Epoch: 6 [57600/100000 (58%)]	Loss: 0.264931
Train Epoch: 6 [64000/100000 (64%)]	Loss: 0.497716
Train Epoch: 6 [70400/100000 (70%)]	Loss: 0.378874
Train Epoch: 6 [76800/100000 (77%)]	Loss: 0.404661
Train Epoch: 6 [83200/100000 (83%)]	Loss: 0.506334
Train Epoch: 6 [89600/100000 (90%)]	Loss: 0.335439
Train Epoch: 6 [96000/100000 (96%)]	Loss: 0.420169

Train set: Average loss: 0.6199, Accuracy: 84741/100000 (84.7%)


Test set test: Average loss: 1.3350, Accuracy: 8006/10000 (80.060%)

Test set test_counterfactual: Average loss: 1.3526, Accuracy: 8028/10000 (80.280%)

Test set test_counterfactual_rot: Average loss: 11.9204, Accuracy: 3817/10000 (38.170%)

Test set test_counterfactual_rot_scale: Average loss: 7.9700, Accuracy: 4265/10000 (42.650%)

Test set test_counterfactual_rot_scale_shear: Average loss: 7.9472, Accuracy: 4011/10000 (40.110%)
Train Epoch: 7 [0/100000 (0%)]	Loss: 0.357167
Train Epoch: 7 [6400/100000 (6%)]	Loss: 0.306889
Train Epoch: 7 [12800/100000 (13%)]	Loss: 0.314525
Train Epoch: 7 [19200/100000 (19%)]	Loss: 0.472930
Train Epoch: 7 [25600/100000 (26%)]	Loss: 0.459090
Train Epoch: 7 [32000/100000 (32%)]	Loss: 0.414460
Train Epoch: 7 [38400/100000 (38%)]	Loss: 0.587583
Train Epoch: 7 [44800/100000 (45%)]	Loss: 0.402180
Train Epoch: 7 [51200/100000 (51%)]	Loss: 0.344340
Train Epoch: 7 [57600/100000 (58%)]	Loss: 0.355389
Train Epoch: 7 [64000/100000 (64%)]	Loss: 0.606647
Train Epoch: 7 [70400/100000 (70%)]	Loss: 0.452965
Train Epoch: 7 [76800/100000 (77%)]	Loss: 0.363927
Train Epoch: 7 [83200/100000 (83%)]	Loss: 0.302949
Train Epoch: 7 [89600/100000 (90%)]	Loss: 0.370008
Train Epoch: 7 [96000/100000 (96%)]	Loss: 0.406605

Train set: Average loss: 0.2052, Accuracy: 86138/100000 (86.1%)


Test set test: Average loss: 1.4751, Accuracy: 7966/10000 (79.660%)

Test set test_counterfactual: Average loss: 1.4901, Accuracy: 7986/10000 (79.860%)

Test set test_counterfactual_rot: Average loss: 12.5363, Accuracy: 3753/10000 (37.530%)

Test set test_counterfactual_rot_scale: Average loss: 8.5619, Accuracy: 4237/10000 (42.370%)

Test set test_counterfactual_rot_scale_shear: Average loss: 8.5383, Accuracy: 3954/10000 (39.540%)
Train Epoch: 8 [0/100000 (0%)]	Loss: 0.495953
Train Epoch: 8 [6400/100000 (6%)]	Loss: 0.368882
Train Epoch: 8 [12800/100000 (13%)]	Loss: 0.152580
Train Epoch: 8 [19200/100000 (19%)]	Loss: 0.208997
Train Epoch: 8 [25600/100000 (26%)]	Loss: 0.323543
Train Epoch: 8 [32000/100000 (32%)]	Loss: 0.316002
Train Epoch: 8 [38400/100000 (38%)]	Loss: 0.290771
Train Epoch: 8 [44800/100000 (45%)]	Loss: 0.382751
Train Epoch: 8 [51200/100000 (51%)]	Loss: 0.325114
Train Epoch: 8 [57600/100000 (58%)]	Loss: 0.363074
Train Epoch: 8 [64000/100000 (64%)]	Loss: 0.386039
Train Epoch: 8 [70400/100000 (70%)]	Loss: 0.340457
Train Epoch: 8 [76800/100000 (77%)]	Loss: 0.373888
Train Epoch: 8 [83200/100000 (83%)]	Loss: 0.312664
Train Epoch: 8 [89600/100000 (90%)]	Loss: 0.412180
Train Epoch: 8 [96000/100000 (96%)]	Loss: 0.383966

Train set: Average loss: 0.2539, Accuracy: 87135/100000 (87.1%)


Test set test: Average loss: 1.5526, Accuracy: 7963/10000 (79.630%)

Test set test_counterfactual: Average loss: 1.5684, Accuracy: 7988/10000 (79.880%)

Test set test_counterfactual_rot: Average loss: 12.4992, Accuracy: 3881/10000 (38.810%)

Test set test_counterfactual_rot_scale: Average loss: 8.5102, Accuracy: 4315/10000 (43.150%)

Test set test_counterfactual_rot_scale_shear: Average loss: 8.5058, Accuracy: 4060/10000 (40.600%)
Train Epoch: 9 [0/100000 (0%)]	Loss: 0.402515
Train Epoch: 9 [6400/100000 (6%)]	Loss: 0.582354
Train Epoch: 9 [12800/100000 (13%)]	Loss: 0.271489
Train Epoch: 9 [19200/100000 (19%)]	Loss: 0.553248
Train Epoch: 9 [25600/100000 (26%)]	Loss: 0.412568
Train Epoch: 9 [32000/100000 (32%)]	Loss: 0.345227
Train Epoch: 9 [38400/100000 (38%)]	Loss: 0.384822
Train Epoch: 9 [44800/100000 (45%)]	Loss: 0.473297
Train Epoch: 9 [51200/100000 (51%)]	Loss: 0.364235
Train Epoch: 9 [57600/100000 (58%)]	Loss: 0.220648
Train Epoch: 9 [64000/100000 (64%)]	Loss: 0.369102
Train Epoch: 9 [70400/100000 (70%)]	Loss: 0.412574
Train Epoch: 9 [76800/100000 (77%)]	Loss: 0.236406
Train Epoch: 9 [83200/100000 (83%)]	Loss: 0.241740
Train Epoch: 9 [89600/100000 (90%)]	Loss: 0.602953
Train Epoch: 9 [96000/100000 (96%)]	Loss: 0.240826

Train set: Average loss: 0.3169, Accuracy: 87697/100000 (87.7%)


Test set test: Average loss: 1.5064, Accuracy: 8007/10000 (80.070%)

Test set test_counterfactual: Average loss: 1.5295, Accuracy: 8023/10000 (80.230%)

Test set test_counterfactual_rot: Average loss: 13.4551, Accuracy: 3778/10000 (37.780%)

Test set test_counterfactual_rot_scale: Average loss: 8.9946, Accuracy: 4254/10000 (42.540%)

Test set test_counterfactual_rot_scale_shear: Average loss: 8.9936, Accuracy: 3989/10000 (39.890%)
Train Epoch: 10 [0/100000 (0%)]	Loss: 0.334761
Train Epoch: 10 [6400/100000 (6%)]	Loss: 0.437027
Train Epoch: 10 [12800/100000 (13%)]	Loss: 0.371171
Train Epoch: 10 [19200/100000 (19%)]	Loss: 0.272609
Train Epoch: 10 [25600/100000 (26%)]	Loss: 0.380821
Train Epoch: 10 [32000/100000 (32%)]	Loss: 0.377278
Train Epoch: 10 [38400/100000 (38%)]	Loss: 0.475914
Train Epoch: 10 [44800/100000 (45%)]	Loss: 0.201726
Train Epoch: 10 [51200/100000 (51%)]	Loss: 0.477437
Train Epoch: 10 [57600/100000 (58%)]	Loss: 0.280677
Train Epoch: 10 [64000/100000 (64%)]	Loss: 0.276745
Train Epoch: 10 [70400/100000 (70%)]	Loss: 0.336534
Train Epoch: 10 [76800/100000 (77%)]	Loss: 0.181797
Train Epoch: 10 [83200/100000 (83%)]	Loss: 0.447303
Train Epoch: 10 [89600/100000 (90%)]	Loss: 0.292078
Train Epoch: 10 [96000/100000 (96%)]	Loss: 0.432991

Train set: Average loss: 0.3659, Accuracy: 88312/100000 (88.3%)


Test set test: Average loss: 1.5735, Accuracy: 8002/10000 (80.020%)

Test set test_counterfactual: Average loss: 1.5983, Accuracy: 7990/10000 (79.900%)

Test set test_counterfactual_rot: Average loss: 13.1511, Accuracy: 3790/10000 (37.900%)

Test set test_counterfactual_rot_scale: Average loss: 8.9361, Accuracy: 4247/10000 (42.470%)

Test set test_counterfactual_rot_scale_shear: Average loss: 8.9510, Accuracy: 4021/10000 (40.210%)
